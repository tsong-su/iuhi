<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>è¯å°æ°´æœèªè©é…å°</title>
<style>
:root{
  --header-h:14vh;
  --footer-h:11vh;
  --grid-h: calc((100vh - var(--header-h) - var(--footer-h) - 22px) / 2);
}
*{box-sizing:border-box}
body{
  margin:0; font-family:"Microsoft JhengHei", "Noto Sans TC", sans-serif;
  background: linear-gradient(180deg,#fffaf0 0%, #fff3df 100%);
  color:#222;
  min-height:100vh; display:flex; flex-direction:column; align-items:center;
}

header{
  height:var(--header-h);
  width:100%;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:8px 12px; text-align:center;
}

.title-row{
  display:flex; align-items:center; gap:10px;
  font-size:clamp(20px,5vw,30px);
  font-weight:800;
  color:#ff6f00;
}
.title-row img{ width:44px; height:44px; object-fit:contain; }

.subtitle{
  margin-top:6px;
  font-size:clamp(14px,2.6vw,18px);
  color:#1565c0;
}
.view-hint{
  margin-top:4px;
  font-size:clamp(16px,3vw,20px);
  color:#d81b60;
  font-weight:800;
}

main{ width:100%; display:flex; flex-direction:column; align-items:center; gap:8px; padding:6px 0; }

.grid-area{
  width:100%;
  max-width:720px;
  height:var(--grid-h);
  display:grid;
  grid-template-columns:repeat(4,1fr);
  grid-template-rows:repeat(4,1fr);
  gap:8px;
  padding: 0 4%;
}

.cell{
  border-radius:14px;
  border:2px solid rgba(0,0,0,0.12);
  display:flex; align-items:center; justify-content:center;
  padding:6px;
  text-align:center;
  cursor:pointer;
  transition: transform .12s ease, box-shadow .12s ease;
  user-select:none;
  overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
  font-weight:700;
  font-size: clamp(16px, 3vw, 22px);
  min-height: 44px;
}
.cell:active{ transform: translateY(2px); }

#grid-cn .cell{ background: #e3f2fd; color:#0b2340; }
#grid-tw .cell{ background: #fff0f6; color:#2b1f2f; }

.cell.selected{ outline:4px solid rgba(33,150,243,0.85); outline-offset:-6px; }
.cell.matched{ pointer-events:none; color:#fff; }

footer{
  height:var(--footer-h);
  width:100%;
  display:flex; align-items:center; justify-content:center; gap:12px; padding:8px;
}

button.btn {
  padding:10px 14px; border-radius:10px; border:none; font-weight:800; font-size:clamp(14px,2.4vw,18px);
  cursor:pointer; color:#fff;
}
#btn-restart{ background:#ffb74d }
#btn-prev{ background:#3498db }
#btn-next{ background:#4fc3f7 }
#btn-home{ background:#81c784 }

#victory {
  position: fixed; left:50%; top:44%; transform:translate(-50%,-50%) scale(.2);
  font-size: clamp(28px,6vw,48px); color:#e91e63; font-weight:900; opacity:0;
  transition: all .45s cubic-bezier(.2,.9,.2,1);
  pointer-events:none;
}
#victory.show { transform:translate(-50%,-50%) scale(1.2); opacity:1; }

@media (min-width:900px){
  :root{ --header-h:12vh; --footer_h:10vh; }
}
</style>
</head>
<body>
  <header>
    <div class="title-row">
      <img id="leftImg" src="game9_assets/fruit_left.png" alt="left fruit">
      <div id="titleText">è¯å°æ°´æœèªè©é…å° - ç¬¬1å›</div>
      <img id="rightImg" src="game9_assets/fruit_right.png" alt="right fruit">
    </div>
    <div class="subtitle" id="subtitle">tshiÌh è¯æ–‡æŠ‘æ˜¯å°èªæ”æœƒä½¿ï¼Œé…å°æˆåŠŸæœƒæœ‰å°èªè²éŸ³æª”å–”ï¼</div>
    <div class="view-hint">ğŸ“± å»ºè­°ç›´å¼è§€çœ‹æ•ˆæœæœ€ä½³</div>
  </header>

  <main>
    <div id="grid-cn" class="grid-area" aria-label="è¯èªæ ¼å­"></div>
    <div id="grid-tw" class="grid-area" aria-label="å°èªæ ¼å­"></div>
    <div id="victory">æœ‰å¤  gÃ¢uï¼</div>
  </main>

  <footer>
    <button id="btn-restart" class="btn">é–£è€ä¸€æ“º</button>
    <button id="btn-prev" class="btn">å‰ä¸€å›</button>
    <button id="btn-next" class="btn">å¾Œä¸€å›</button>
    <button id="btn-home" class="btn">è½‰å»éŠæˆ²é ­é </button>
  </footer>

  <audio id="wrongAudio" src="game9_assets/wrong.mp3" preload="auto"></audio>
  <audio id="victoryAudio" src="game9_assets/victory.mp3" preload="auto"></audio>

<script>
// ä¸‰å›è³‡æ–™
const ROUND_DATA = {
  1:[
    {id:1,chinese:'è˜‹æœ',taiwanese:'è˜‹æœ',audio:'game9_assets/fruit1.mp3'},
    {id:2,chinese:'é¦™è•‰',taiwanese:'é¦™è•‰',audio:'game9_assets/fruit2.mp3'},
    {id:3,chinese:'è‘¡è„',taiwanese:'è‘¡è„',audio:'game9_assets/fruit3.mp3'},
    {id:4,chinese:'è¥¿ç“œ',taiwanese:'è¥¿ç“œ',audio:'game9_assets/fruit4.mp3'},
    {id:5,chinese:'é³³æ¢¨',taiwanese:'é³³æ¢¨',audio:'game9_assets/fruit5.mp3'},
    {id:6,chinese:'æŸšå­',taiwanese:'æŸšå­',audio:'game9_assets/fruit6.mp3'},
    {id:7,chinese:'æœ¨ç“œ',taiwanese:'æœ¨ç“œ',audio:'game9_assets/fruit7.mp3'},
    {id:8,chinese:'è‰è“',taiwanese:'è‰è“',audio:'game9_assets/fruit8.mp3'}
  ],
  2:[
    {id:9,chinese:'è“®éœ§',taiwanese:'è“®éœ§',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3'},
    {id:15,chinese:'æå­',taiwanese:'æä»”',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3227.mp3'},
    {id:35,chinese:'å±±ç«º',taiwanese:'å±±ç«¹',audio:'game9_assets/fruit35.mp3'},
    {id:36,chinese:'å“ˆå¯†ç“œ',taiwanese:'ç¶²ä»”ç“œ',audio:'game9_assets/fruit36.mp3'},
    {id:37,chinese:'å¥‡ç•°æœ',taiwanese:'çŒ´é ­æœ',audio:'game9_assets/fruit37.mp3'},
    {id:38,chinese:'é…ªæ¢¨',taiwanese:'é±·æ¢¨ä»”',audio:'game9_assets/fruit38.mp3'},
    {id:39,chinese:'é‡‘æ©˜',taiwanese:'é‡‘æ£—',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4614.mp3'},
    {id:40,chinese:'ç«é¾æœ',taiwanese:'ç«é¾æœ',audio:'game9_assets/fruit40.mp3'}
  ],
  3:[
    {id:41,chinese:'è‘¡è„æŸš',taiwanese:'è‘¡è„æŸš',audio:'game9_assets/fruit41.mp3'},
    {id:42,chinese:'æ¤ªæŸ‘',taiwanese:'æ¤ªæŸ‘',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8535.mp3'},
    {id:43,chinese:'è—è“',taiwanese:'è—è“',audio:'game9_assets/fruit43.mp3'},
    {id:44,chinese:'å°ç‰è¥¿ç“œ',taiwanese:'å°ç‰ä»”',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/295.mp3'},
    {id:45,chinese:'æ¤°å­',taiwanese:'æ¤°å­',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9575.mp3'},
    {id:46,chinese:'ç•ªèŒ„',taiwanese:'æŸ‘ä»”èœœ',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5090.mp3'},
    {id:47,chinese:'è™é ­æŸ‘',taiwanese:'è™é ­æŸ‘',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4649.mp3'},
    {id:48,chinese:'è‚šè‡æ©™',taiwanese:'è‚šè‡æŸ‘',audio:'game9_assets/fruit48.mp3'}
  ]
};

const COLOR_PALETTE=[
  "#FF5733","#FF8D1A","#FFC300","#DAF7A6",
  "#33FF57","#1AFF8D","#33FFF6","#3380FF",
  "#8D33FF","#FF33F6","#FF3380","#FF6666",
  "#66FF66","#66FFFF","#6666FF","#FFCC00"
];

const gridCn = document.getElementById('grid-cn');
const gridTw = document.getElementById('grid-tw');
const titleText = document.getElementById('titleText');
const victoryEl = document.getElementById('victory');
const wrongAudio = document.getElementById('wrongAudio');
const victoryAudio = document.getElementById('victoryAudio');

let round=1, pairs=[], selected=null, matchedCount=0, playingFinalFlow=false;

function shuffle(arr){ return arr.sort(()=>Math.random()-0.5); }

function loadRound(r){
  round=r;
  titleText.textContent=`è¯å°æ°´æœèªè©é…å° - ç¬¬${round}å›`;
  matchedCount=0; selected=null; playingFinalFlow=false;
  victoryEl.classList.remove('show');
  const arr=ROUND_DATA[round];
  pairs=arr.map((p,i)=>({...p,color:COLOR_PALETTE[i%COLOR_PALETTE.length]}));
  renderGrids();
}

function renderGrids(){
  gridCn.innerHTML=''; gridTw.innerHTML=''; matchedCount=0; selected=null; victoryEl.classList.remove('show');
  pairs.forEach(p=>{
    const d=document.createElement('div');
    d.className='cell'; d.textContent=p.chinese;
    d.dataset.pairId=p.id; d.dataset.type='cn';
    d.addEventListener('click',()=>onCellClick(d));
    gridCn.appendChild(d);
  });
  const shuffled=pairs.slice().sort(()=>Math.random()-0.5);
  shuffled.forEach(p=>{
    const d=document.createElement('div');
    d.className='cell'; d.textContent=p.taiwanese;
    d.dataset.pairId=p.id; d.dataset.type='tw';
    d.addEventListener('click',()=>onCellClick(d));
    gridTw.appendChild(d);
  });
}

function onCellClick(el){
  if(playingFinalFlow||el.classList.contains('matched')) return;
  if(!selected){ selected={el, id:el.dataset.pairId, type:el.dataset.type}; el.classList.add('selected'); return; }
  if(selected.el===el){ el.classList.remove('selected'); selected=null; return; }
  el.classList.add('selected');
  const first=selected, second={el, id:el.dataset.pairId, type:el.dataset.type};
  if(first.id===second.id && first.type!==second.type){
    const pair=pairs.find(p=>p.id==first.id);
    const color=pair.color;
    first.el.classList.add('matched'); second.el.classList.add('matched');
    first.el.style.background=color; second.el.style.background=color;
    first.el.style.color='#fff'; second.el.style.color='#fff';
    matchedCount++;
    if(matchedCount===pairs.length){
      playingFinalFlow=true;
      if(pair.audio){
        const audio=new Audio(pair.audio);
        audio.play().catch(()=>{});
        audio.onended = ()=>{
          setTimeout(()=>{
            victoryAudio.play().catch(()=>{});
            victoryEl.classList.add('show');
            setTimeout(()=>{playingFinalFlow=false;},2500);
          },700);
        };
      } else {
        setTimeout(()=>{
          victoryAudio.play().catch(()=>{});
          victoryEl.classList.add('show');
          setTimeout(()=>{playingFinalFlow=false;},2500);
        },700);
      }
    } else {
      if(pair.audio){ new Audio(pair.audio).play().catch(()=>{}); }
    }
  } else {
    try{ wrongAudio.currentTime=0; wrongAudio.play().catch(()=>{}); }catch(e){}
    first.el.classList.add('shake'); second.el.classList.add('shake');
   
