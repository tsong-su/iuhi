<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8" />
  <title>華台水果語詞配對 - 三回整合版</title>
  <style>
    body {
      font-family: "jf open 粉圓", "Microsoft JhengHei", sans-serif;
      text-align: center;
      background-color: #fff8f0;
      margin: 0;
    }
    h1 {
      color: #d2691e;
      margin-top: 15px;
    }
    .game-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      margin-top: 20px;
      gap: 15px;
    }
    .fruit {
      width: 100px;
      height: 100px;
      border: 3px solid #f4a460;
      border-radius: 15px;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .fruit:hover {
      transform: scale(1.1);
    }
    .word {
      width: 120px;
      padding: 10px;
      border: 3px solid #ffa07a;
      border-radius: 15px;
      background-color: #fff;
      cursor: pointer;
      font-size: 18px;
      transition: background-color 0.3s;
    }
    .word:hover {
      background-color: #ffefd5;
    }
    #message {
      font-size: 26px;
      color: #d2691e;
      margin-top: 15px;
      font-weight: bold;
    }
    .buttons {
      margin-top: 25px;
    }
    button {
      font-size: 18px;
      margin: 5px;
      padding: 10px 18px;
      border-radius: 10px;
      border: none;
      background-color: #f4a460;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #d2691e;
    }
  </style>
</head>
<body>
  <h1 id="title">華台水果語詞配對 - 第1回</h1>
  <div class="game-container" id="fruit-container"></div>
  <div class="game-container" id="word-container"></div>
  <div id="message"></div>
  <div class="buttons">
    <button id="prev-btn" style="display:none;">前一回</button>
    <button id="next-btn">後一回</button>
  </div>

  <audio id="correct-sound" src="correct.mp3"></audio>
  <audio id="win-sound" src="win.mp3"></audio>

  <script>
    const rounds = [
      // 第1回
      [
        ["fruit1.png", "蘋果 / 蘋果", "fruit1.mp3"],
        ["fruit2.png", "香蕉 / 蕉仔", "fruit2.mp3"],
        ["fruit3.png", "芒果 / 芒果", "fruit3.mp3"],
        ["fruit4.png", "鳳梨 / 旺來", "fruit4.mp3"],
        ["fruit5.png", "西瓜 / 西瓜", "fruit5.mp3"],
        ["fruit6.png", "草莓 / 莓仔", "fruit6.mp3"],
        ["fruit7.png", "橘子 / 柑仔", "fruit7.mp3"],
        ["fruit8.png", "柳丁 / 柳丁", "fruit8.mp3"]
      ],
      // 第2回
      [
        ["fruit17.png", "櫻桃 / 櫻桃", "fruit17.mp3"],
        ["fruit18.png", "柚子 / 文旦", "fruit18.mp3"],
        ["fruit19.png", "龍眼 / 龍眼", "fruit19.mp3"],
        ["fruit20.png", "荔枝 / 荔枝", "fruit20.mp3"],
        ["fruit21.png", "柿子 / 柿仔", "fruit21.mp3"],
        ["fruit22.png", "檸檬 / 檸檬", "fruit22.mp3"],
        ["fruit23.png", "石榴 / 石榴", "fruit23.mp3"],
        ["fruit24.png", "桑葚 / 烏梅", "fruit24.mp3"]
      ],
      // 第3回
      [
        ["fruit9.png", "蓮霧 / 蓮霧", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3"],
        ["fruit15.png", "李子 / 李仔", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3227.mp3"],
        ["fruit35.png", "山竺 / 山竹", "fruit35.mp3"],
        ["fruit36.png", "哈密瓜 / 網仔瓜", "fruit36.mp3"],
        ["fruit37.png", "奇異果 / 猴頭果", "fruit37.mp3"],
        ["fruit38.png", "酪梨 / 鱷梨仔", "fruit38.mp3"],
        ["fruit39.png", "金橘 / 金棗", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4614.mp3"],
        ["fruit40.png", "火龍果 / 火龍果", "fruit40.mp3"],
        ["fruit41.png", "葡萄柚 / 葡萄柚", "fruit41.mp3"],
        ["fruit42.png", "椪柑 / 椪柑", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8535.mp3"],
        ["fruit43.png", "藍莓 / 藍莓", "fruit43.mp3"],
        ["fruit44.png", "小玉西瓜 / 小玉仔", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/295.mp3"],
        ["fruit45.png", "椰子 / 椰子", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9575.mp3"],
        ["fruit46.png", "番茄 / 柑仔蜜", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5090.mp3"],
        ["fruit47.png", "虎頭柑 / 虎頭柑", "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4649.mp3"],
        ["fruit48.png", "肚臍橙 / 肚臍柑", "fruit48.mp3"]
      ]
    ];

    let currentRound = 0;
    let matchedCount = 0;
    let selectedFruit = null;
    let selectedWord = null;

    const fruitContainer = document.getElementById("fruit-container");
    const wordContainer = document.getElementById("word-container");
    const message = document.getElementById("message");
    const correctSound = document.getElementById("correct-sound");
    const winSound = document.getElementById("win-sound");

    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    function loadRound(roundIndex) {
      const round = rounds[roundIndex];
      matchedCount = 0;
      selectedFruit = null;
      selectedWord = null;
      message.textContent = "";

      document.getElementById("title").textContent = `華台水果語詞配對 - 第${roundIndex + 1}回`;

      fruitContainer.innerHTML = "";
      wordContainer.innerHTML = "";

      const fruits = shuffle([...round]);
      const words = shuffle([...round]);

      fruits.forEach(([img, word]) => {
        const div = document.createElement("div");
        div.className = "fruit";
        div.innerHTML = `<img src="${img}" alt="${word}" width="90" height="90">`;
        div.onclick = () => selectFruit(div, img, word);
        fruitContainer.appendChild(div);
      });

      words.forEach(([img, word]) => {
        const div = document.createElement("div");
        div.className = "word";
        div.textContent = word;
        div.onclick = () => selectWord(div, img, word);
        wordContainer.appendChild(div);
      });

      // 按鈕顯示控制
      document.getElementById("prev-btn").style.display = (roundIndex === 0) ? "none" : "inline-block";
      document.getElementById("next-btn").textContent = (roundIndex === rounds.length - 1) ? "轉去遊戲頭頁" : "後一回";
    }

    function selectFruit(div, img, word) {
      if (selectedFruit) selectedFruit.style.borderColor = "#f4a460";
      selectedFruit = div;
      div.style.borderColor = "red";
      div.dataset.img = img;
    }

    function selectWord(div, img, word) {
      if (selectedWord) selectedWord.style.borderColor = "#ffa07a";
      selectedWord = div;
      div.style.borderColor = "red";
      div.dataset.img = img;
      checkMatch();
    }

    function checkMatch() {
      if (selectedFruit && selectedWord) {
        const fruitImg = selectedFruit.dataset.img;
        const wordImg = selectedWord.dataset.img;
        const round = rounds[currentRound];
        const match = round.find(([img]) => img === fruitImg && img === wordImg);

        if (match) {
          correctSound.play();
          const audio = new Audio(match[2]);
          audio.play();
          selectedFruit.style.visibility = "hidden";
          selectedWord.style.visibility = "hidden";
          matchedCount++;
          if (matchedCount === round.length) {
            setTimeout(() => {
              winSound.play();
              message.textContent = "有夠 gâu！";
            }, 1000);
          }
        }
        selectedFruit.style.borderColor = "#f4a460";
        selectedWord.style.borderColor = "#ffa07a";
        selectedFruit = null;
        selectedWord = null;
      }
    }

    document.getElementById("next-btn").onclick = () => {
      if (currentRound < rounds.length - 1) {
        currentRound++;
        loadRound(currentRound);
      } else {
        window.location.href = "index.html";
      }
    };

    document.getElementById("prev-btn").onclick = () => {
      if (currentRound > 0) {
        currentRound--;
        loadRound(currentRound);
      }
    };

    loadRound(currentRound);
  </script>
</body>
</html>
