<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>華台水果語詞配對</title>
<style>
:root{
  --header-h:14vh;
  --footer-h:11vh;
  --grid-h: calc((100vh - var(--header-h) - var(--footer-h) - 22px) / 2);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Microsoft JhengHei","Noto Sans TC",sans-serif;
  background:linear-gradient(180deg,#fffaf0 0%,#fff3df 100%);
  color:#222;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
}
header{
  height:var(--header-h);
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:8px 12px;
  text-align:center;
}
.title-row{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:clamp(20px,5vw,30px);
  font-weight:800;
  color:#ff6f00;
}
.title-row img{width:44px;height:44px;object-fit:contain;}
.subtitle{
  margin-top:6px;
  font-size:clamp(14px,2.6vw,18px);
  color:#1565c0;
}
.view-hint{
  margin-top:4px;
  font-size:clamp(16px,3vw,20px);
  color:#d81b60;
  font-weight:800;
}
main{
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
  padding:6px 0;
}
.grid-area{
  width:100%;
  max-width:720px;
  height:var(--grid-h);
  display:grid;
  grid-template-columns:repeat(4,1fr);
  grid-template-rows:repeat(4,1fr);
  gap:8px;
  padding:0 4%;
}
.cell{
  border-radius:14px;
  border:2px solid rgba(0,0,0,0.12);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:6px;
  text-align:center;
  cursor:pointer;
  transition:transform .12s ease,box-shadow .12s ease;
  user-select:none;
  overflow:hidden;
  white-space:nowrap;
  text-overflow:ellipsis;
  font-weight:700;
  font-size:clamp(16px,3vw,22px);
  min-height:44px;
}
.cell:active{transform:translateY(2px);}
#grid-cn .cell{background:#e3f2fd;color:#0b2340;}
#grid-tw .cell{background:#fff0f6;color:#2b1f2f;}
.cell.selected{outline:4px solid rgba(33,150,243,0.85);outline-offset:-6px;}
.cell.matched{pointer-events:none;color:#fff;}
footer{
  height:var(--footer-h);
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:12px;
  padding:8px;
}
button.btn{
  padding:10px 14px;
  border-radius:10px;
  border:none;
  font-weight:800;
  font-size:clamp(14px,2.4vw,18px);
  cursor:pointer;
  color:#fff;
}
#btn-restart{background:#ffb74d;}
#btn-prev{background:#3498db;}
#btn-next{background:#4fc3f7;}
#btn-home{background:#81c784;}
#victory{
  position:fixed;
  left:50%;
  top:44%;
  transform:translate(-50%,-50%) scale(.2);
  font-size:clamp(28px,6vw,48px);
  color:#e91e63;
  font-weight:900;
  opacity:0;
  transition:all .45s cubic-bezier(.2,.9,.2,1);
  pointer-events:none;
}
#victory.show{transform:translate(-50%,-50%) scale(1.2);opacity:1;}
</style>
</head>
<body>
<header>
  <div class="title-row">
    <img src="game9_assets/fruit_left.png" alt="left">
    <div id="titleText">華台水果語詞配對 - 第1回</div>
    <img src="game9_assets/fruit_right.png" alt="right">
  </div>
  <div class="subtitle">tshi̍h 華文抑是台語攏會使，配對成功會有台語聲音檔喔！</div>
  <div class="view-hint">📱 建議直式觀看效果最佳</div>
</header>

<main>
  <div id="grid-cn" class="grid-area"></div>
  <div id="grid-tw" class="grid-area"></div>
  <div id="victory">有夠 gâu！</div>
</main>

<footer>
  <button id="btn-restart" class="btn">閣耍一擺</button>
  <button id="btn-prev" class="btn">前一回</button>
  <button id="btn-next" class="btn">後一回</button>
  <button id="btn-home" class="btn">轉去遊戲頭頁</button>
</footer>

<audio id="wrongAudio" src="game9_assets/wrong.mp3" preload="auto"></audio>
<audio id="victoryAudio" src="game9_assets/victory.mp3" preload="auto"></audio>

<script>
const ROUND_DATA={
1:[
{id:1,chinese:'蘋果',taiwanese:'蘋果',audio:'game9_assets/fruit1.mp3'},
{id:2,chinese:'香蕉',taiwanese:'香蕉',audio:'game9_assets/fruit2.mp3'},
{id:3,chinese:'葡萄',taiwanese:'葡萄',audio:'game9_assets/fruit3.mp3'},
{id:4,chinese:'西瓜',taiwanese:'西瓜',audio:'game9_assets/fruit4.mp3'},
{id:5,chinese:'鳳梨',taiwanese:'鳳梨',audio:'game9_assets/fruit5.mp3'},
{id:6,chinese:'柚子',taiwanese:'柚子',audio:'game9_assets/fruit6.mp3'},
{id:7,chinese:'木瓜',taiwanese:'木瓜',audio:'game9_assets/fruit7.mp3'},
{id:8,chinese:'草莓',taiwanese:'草莓',audio:'game9_assets/fruit8.mp3'}
],
2:[
{id:9,chinese:'蓮霧',taiwanese:'蓮霧',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3'},
{id:15,chinese:'李子',taiwanese:'李仔',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3227.mp3'},
{id:35,chinese:'山竺',taiwanese:'山竹',audio:'game9_assets/fruit35.mp3'},
{id:36,chinese:'哈密瓜',taiwanese:'網仔瓜',audio:'game9_assets/fruit36.mp3'},
{id:37,chinese:'奇異果',taiwanese:'猴頭果',audio:'game9_assets/fruit37.mp3'},
{id:38,chinese:'酪梨',taiwanese:'鱷梨仔',audio:'game9_assets/fruit38.mp3'},
{id:39,chinese:'金橘',taiwanese:'金棗',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4614.mp3'},
{id:40,chinese:'火龍果',taiwanese:'火龍果',audio:'game9_assets/fruit40.mp3'}
],
3:[
{id:41,chinese:'葡萄柚',taiwanese:'葡萄柚',audio:'game9_assets/fruit41.mp3'},
{id:42,chinese:'椪柑',taiwanese:'椪柑',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8535.mp3'},
{id:43,chinese:'藍莓',taiwanese:'藍莓',audio:'game9_assets/fruit43.mp3'},
{id:44,chinese:'小玉西瓜',taiwanese:'小玉仔',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/295.mp3'},
{id:45,chinese:'椰子',taiwanese:'椰子',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9575.mp3'},
{id:46,chinese:'番茄',taiwanese:'柑仔蜜',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5090.mp3'},
{id:47,chinese:'虎頭柑',taiwanese:'虎頭柑',audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4649.mp3'},
{id:48,chinese:'肚臍橙',taiwanese:'肚臍柑',audio:'game9_assets/fruit48.mp3'}
]
};

const COLORS=["#FF5733","#FF8D1A","#FFC300","#33FF57","#1AFF8D","#33FFF6","#3380FF","#8D33FF","#FF33F6","#FF3380","#FF6666","#66FF66","#66FFFF","#6666FF","#FFCC00","#F48FB1"];
let round=1,selected=null,matched=0,lock=false;
const cn=document.getElementById('grid-cn'),tw=document.getElementById('grid-tw'),title=document.getElementById('titleText');
const victory=document.getElementById('victory'),wrong=document.getElementById('wrongAudio'),victoryAudio=document.getElementById('victoryAudio');

function shuffle(a){return a.sort(()=>Math.random()-.5)}
function loadRound(r){
 round=r;title.textContent=`華台水果語詞配對 - 第${r}回`;
 selected=null;matched=0;lock=false;victory.classList.remove('show');
 cn.innerHTML='';tw.innerHTML='';
 const arr=shuffle(ROUND_DATA[r].slice());
 const arrTw=shuffle(ROUND_DATA[r].slice());
 arr.forEach((p,i)=>{
  const c=document.createElement('div');
  c.className='cell';c.textContent=p.chinese;c.dataset.id=p.id;c.dataset.type='cn';c.style.background='#e3f2fd';
  c.addEventListener('click',()=>clickCell(c));cn.appendChild(c);
 });
 arrTw.forEach((p,i)=>{
  const c=document.createElement('div');
  c.className='cell';c.textContent=p.taiwanese;c.dataset.id=p.id;c.dataset.type='tw';c.style.background='#fff0f6';
  c.addEventListener('click',()=>clickCell(c));tw.appendChild(c);
 });
}

function clickCell(cell){
 if(lock||cell.classList.contains('matched'))return;
 if(!selected){selected=cell;cell.classList.add('selected');return;}
 if(selected===cell){cell.classList.remove('selected');selected=null;return;}
 if(selected.dataset.id===cell.dataset.id && selected.dataset.type!==cell.dataset.type){
   const color=COLORS[matched%COLORS.length];
   selected.classList.add('matched');cell.classList.add('matched');
   selected.style.background=color;cell.style.background=color;selected.style.color='#fff';cell.style.color='#fff';
   const audio=new Audio(ROUND_DATA[round].find(p=>p.id==cell.dataset.id).audio);
   audio.play().catch(()=>{});
   matched++;
   if(matched===ROUND_DATA[round].length){
     lock=true;
     audio.onended=()=>setTimeout(()=>{
       victoryAudio.play().catch(()=>{});
       victory.classList.add('show');
       lock=false;
     },800);
   }
   selected.classList.remove('selected');selected=null;
 }else{
   wrong.currentTime=0;wrong.play().catch(()=>{});
   selected.classList.remove('selected');cell.classList.remove('selected');
   selected=null;
 }
}

document.getElementById('btn-restart').onclick=()=>loadRound(round);
document.getElementById('btn-home').onclick=()=>window.location.href='index.html';
document.getElementById('btn-next').onclick=()=>{
 if(round<3)loadRound(round+1);
};
document.getElementById('btn-prev').onclick=()=>{
 if(round>1)loadRound(round-1);
};

loadRound(1);
</script>
</body>
</html>
