<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
<title>é«˜é›„å¸‚38å€æ–°èˆŠåœ°åäº’å‹•åœ°åœ–</title>
<style>
  :root{
    --ink:#1f2937; --muted:#6b7280; --bg:#fafafa;
    --red:#f87171;     /* å¸‚ä¸­å¿ƒ æš–ç´… */
    --purple:#c4b5fd;  /* æ±å€    ç´« */
    --ylg:#bbf7d0;     /* åŒ—å€  é»ƒç¶  */
    --cyan:#99f6e4;    /* å±±å€ è—ç¶  */
    --card:rgba(255,255,255,.92);
  }
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"Noto Sans TC","Microsoft JhengHei",system-ui,-apple-system,Arial}
  header{padding:14px 16px 8px}
  h1{margin:0 0 6px 0;font-size:20px;line-height:1.2}
  .hint{margin:0;color:var(--muted);font-size:14px}
  .wrap{padding:8px 10px 18px}
  .mapbox{position:relative;border:1px solid #e5e7eb;border-radius:14px;background:#fff;box-shadow:0 6px 20px rgba(0,0,0,.06);overflow:hidden}
  svg{display:block;width:100%;height:calc(100vh - 160px);max-height:980px}
  @media (max-width:720px){
    svg{height:calc(100vh - 180px)}
  }
  /* æµ®å‹•è³‡è¨Šå¡ */
  .tooltip{
    position:absolute;min-width:220px;max-width:86vw;pointer-events:none;
    background:var(--card);backdrop-filter:saturate(140%) blur(6px);
    border:1px solid rgba(0,0,0,.06);border-radius:12px;box-shadow:0 10px 28px rgba(0,0,0,.16);
    padding:12px 12px 10px;opacity:0;transform:translate(-50%,-14px) scale(.98);
    transition:opacity .25s ease, transform .25s ease;
  }
  .tooltip.show{opacity:1;transform:translate(-50%,-18px) scale(1)}
  .tooltip h3{margin:0 0 2px;font-size:16px;color:#b91c1c;font-weight:700}
  .tooltip h4{margin:0 0 6px;font-size:15px;color:#111827;font-weight:600}
  .py{margin:0;color:#4b5563;font-size:14px;line-height:1.25}
  .btns{margin-top:8px;display:flex;gap:8px}
  .btn{
    pointer-events:auto;padding:6px 10px;font-size:13px;border-radius:10px;border:1px dashed #cbd5e1;
    background:#f3f4f6;color:#9ca3af;cursor:not-allowed;
  }
  /* hover æäº® */
  .area-hover{transition:filter .3s ease}
  .area-hover:hover{filter:brightness(1.15)}
  /* èªªæ˜è‰²å¡Š */
  .legend{display:flex;flex-wrap:wrap;gap:8px;padding:10px 12px 2px;color:#374151}
  .chip{display:inline-flex;align-items:center;gap:8px;border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px 4px 4px}
  .dot{width:14px;height:14px;border-radius:50%}
</style>
</head>
<body>
  <header>
    <h1>é«˜é›„å¸‚38å€æ–°èˆŠåœ°åäº’å‹•åœ°åœ–</h1>
    <p class="hint">ğŸ“± å»ºè­°ç›´å¼è§€çœ‹æ•ˆæœæœ€ä½³</p>
  </header>

  <div class="legend">
    <span class="chip"><span class="dot" style="background:var(--red)"></span>å¸‚ä¸­å¿ƒ</span>
    <span class="chip"><span class="dot" style="background:var(--purple)"></span>å¸‚éƒŠâ€“æ±</span>
    <span class="chip"><span class="dot" style="background:var(--ylg)"></span>å¸‚éƒŠâ€“åŒ—</span>
    <span class="chip"><span class="dot" style="background:var(--cyan)"></span>å±±å€</span>
  </div>

  <div class="wrap">
    <div class="mapbox">
      <div id="tip" class="tooltip" role="dialog" aria-live="polite"></div>
      <svg id="stage" viewBox="0 0 1143.062 1440.995" preserveAspectRatio="xMidYMid meet" aria-label="é«˜é›„å¸‚è¡Œæ”¿å€äº’å‹•åœ°åœ–">
        <g id="svgRoot"></g>
      </svg>
    </div>
  </div>

<script>
/* ---------- 1) ä½ çš„ SVG ä¾†æº ---------- */
/* è‹¥ä½ æ”¹æ”¾æœ¬åœ°æª”æ¡ˆï¼Œæ”¹æˆ 'map_assets/Blank_Kaohsiung_map.svg' å³å¯ */
const SVG_URL = 'https://raw.githubusercontent.com/tsong-su/iuhi/refs/heads/main/map_assets/Blank_Kaohsiung_map.svg';

/* ---------- 2) å››ç¾¤åˆ†è‰²èˆ‡è³‡æ–™ï¼ˆæ¡ç”¨ä½ æœ€æ–°ä¿®æ­£ç‰ˆï¼‰ ---------- */
const GROUPS = {
  center: ["æ¥ æ¢“","å·¦ç‡Ÿ","é¼“å±±","ä¸‰æ°‘","é¹½åŸ•","å‰é‡‘","æ–°èˆˆ","è‹“é›…","æ——æ´¥","å‰é®","å°æ¸¯"],
  east:   ["å¤§æ¨¹","å¤§å¯®","æ—åœ’","å¤§ç¤¾","ä»æ­¦","é³¥æ¾","é³³å±±"],
  north:  ["èŒ„è£","æ°¸å®‰","å½Œé™€","æ¢“å®˜","æ¹–å…§","è·¯ç«¹","å²¡å±±","æ©‹é ­","é˜¿è“®","ç”°å¯®","ç‡•å·¢"],
  mount:  ["å…§é–€","æ——å±±","æ‰æ—","ç¾æ¿ƒ","ç”²ä»™","å…­é¾œ","é‚£ç‘ªå¤","æ¡ƒæº","èŒ‚æ—"]
};
const GROUP_COLOR = { center:'var(--red)', east:'var(--purple)', north:'var(--ylg)', mount:'var(--cyan)' };

/* æ–°ï¼èˆŠåœ°å + å°èªæ‹¼éŸ³ï¼ˆæ¡å…©è¡Œé¡¯ç¤ºæ‹¼éŸ³ï¼›éµåç”¨ã€Œæ–°åœ°åã€ï¼‰ */
const DATA = {
  "æ¥ æ¢“":{old:"æ¥ ä»”å‘", pyNew:"LÃ¢m-tsÃº", pyOld:"LÃ¢m-Ã¡-khenn"},
  "å·¦ç‡Ÿ":{old:"åŸ¤ä»”é ­", pyNew:"TsÃ³-iÃ¢nn", pyOld:"Pi-Ã¡-thÃ¢u"},
  "é¼“å±±":{old:"æ‰“ç‹—å±±", pyNew:"KÃ³o-san", pyOld:"TÃ¡nn-kÃ³o-san"},
  "ä¸‰æ°‘":{old:"ä¸‰å¡Šå", pyNew:"Sam-bÃ®n", pyOld:"Sann-tÃ¨-tshÃ¹"},
  "é¹½åŸ•":{old:"é¹½åŸ•åŸ”", pyNew:"IÃ¢m-tiÃ¢nn", pyOld:"IÃ¢m-tiÃ¢nn-poo"},
  "å‰é‡‘":{old:"å‰è¡¿",   pyNew:"TsiÃ¢n-kim", pyOld:"TsiÃ¢n-khim"},
  "æ–°èˆˆ":{old:"é€®æ¸¯åŸ”", pyNew:"Sin-hing",  pyOld:"TÄi-kÃ¡ng-poo"},
  "è‹“é›…":{old:"ç¬­ä»”å¯®", pyNew:"LÃ®ng-ngÃ¡",  pyOld:"LÃ®ng-Ã¡-liÃ¢u"},
  "æ——æ´¥":{old:"æ——å¾Œ",   pyNew:"KÃ®-tin",    pyOld:"KÃ®-Äu"},
  "å‰é®":{old:"å‰é®",   pyNew:"TsiÃ¢n-tÃ¬n", pyOld:"TsiÃ¢n-tÃ¬n"},
  "å°æ¸¯":{old:"æ¸¯ä»”å¢˜", pyNew:"SiÃ³-kÃ¡ng",  pyOld:"KÃ¡ng-Ã¡ kÃ®nn"},

  "å¤§æ¨¹":{old:"å¤§æ¨¹è·¤", pyNew:"TuÄ-tshiÅ«", pyOld:"TuÄ-tshiÅ«-kha"},
  "å¤§å¯®":{old:"å¤§è—”",   pyNew:"TuÄ-liÃ¢u",  pyOld:"TuÄ-liÃ¢u"},
  "æ—åœ’":{old:"é ‚æ—ä»”é‚Š", pyNew:"LÃ®m-hnÌ‚g", pyOld:"TÃ­ng-nÃ¢-Ã¡-pinn"},
  "å¤§ç¤¾":{old:"ä¸‰å¥¶å£‡",  pyNew:"TuÄ-siÄ",   pyOld:"Sam-nÃ¡i-tuÃ¢nn"},
  "ä»æ­¦":{old:"ä»æ­¦åº„",  pyNew:"JÃ®n-bÃº",    pyOld:"JÃ®n-bÃº-tsng"},
  "é³¥æ¾":{old:"é³¥æ¾è·¤",  pyNew:"TsiÃ¡u-tshÃ®ng", pyOld:"TsiÃ¡u-tshÃ®ng-kha"},
  "é³³å±±":{old:"ä¸‹åŸ¤é ­",  pyNew:"HÅng-suann",   pyOld:"Ä’-pi-thÃ¢u"},

  "èŒ„è£":{old:"èŒ„è‹³è£ä»”", pyNew:"Ka-tiÄnn",   pyOld:"Ka-tang-tiÄnn-Ã¡"},
  "æ°¸å®‰":{old:"çƒæ¨¹æ—",   pyNew:"Ãng-an",     pyOld:"Oo-tshiÅ«-nÃ¢"},
  "å½Œé™€":{old:"å½Œé™€æ¸¯",   pyNew:"MÃ®-tÃ´",      pyOld:"BÃ®-lÃ´-kÃ¡ng"},
  "æ¢“å®˜":{old:"æ¢“å®˜",     pyNew:"TsÃº-kuann",  pyOld:"TsÃº-kuann"},
  "æ¹–å…§":{old:"å¤§æ¹–",     pyNew:"Ã”o-lÄi",     pyOld:"TuÄ-Ã´o"},
  "è·¯ç«¹":{old:"åŠè·¯ç«¹",   pyNew:"LÅo-tik",    pyOld:"PuÃ nn-lÅo-tik"},
  "å²¡å±±":{old:"é˜¿å…¬åº—",   pyNew:"Kong-san",   pyOld:"A-kong-tiÃ m"},
  "æ©‹é ­":{old:"æ©‹ä»”é ­",   pyNew:"KiÃ´-thÃ¢u",   pyOld:"KiÃ´-Ã¡-thÃ¢u"},
  "é˜¿è“®":{old:"é˜¿å—¹ç¤¾",   pyNew:"A-lian",     pyOld:"A-lian-siÄ"},
  "ç”°å¯®":{old:"ç”°è—”",     pyNew:"TshÃ¢n-liÃ¢u", pyOld:"TshÃ¢n-liÃ¢u"},
  "ç‡•å·¢":{old:"æ´å‰¿å³",   pyNew:"IÃ n-tsÃ¢u",   pyOld:"UÄn-tsÃ¢u-iÅ«"},

  "å…§é–€":{old:"ç¾…æ¼¢å…§é–€", pyNew:"LÄi-bÃ»n",    pyOld:"LÃ´-hÃ n-lÄi-bÃ»n"},
  "æ——å±±":{old:"è•ƒè–¯è—”",   pyNew:"KÃ®-san",     pyOld:"Han-tsÃ®-liÃ¢u"},
  "æ‰æ—":{old:"æ¥ æ¢“ä»™",   pyNew:"Sam-nÃ¢",     pyOld:"LÃ¢m-tsÃº-sian"},
  "ç¾æ¿ƒ":{old:"ç€°æ¿ƒ",     pyNew:"Bi-long",    pyOld:"BÃ®-long"},
  "ç”²ä»™":{old:"é˜¿é‡Œé—œ",   pyNew:"Kah-sian",   pyOld:"A-lÃ­-kuan"},
  "å…­é¾œ":{old:"å…­é¾œé‡Œç¤¾", pyNew:"LaÌk-ku",     pyOld:"LaÌk-ku-lÃ­-siÄ"},
  "é‚£ç‘ªå¤":{old:"èšŠå­åª",  pyNew:"Na-mÃ¡-siah", pyOld:"Mangacun/BÃ¡ng-Ã¡-tsÃ­"},
  "æ¡ƒæº":{old:"é›…çˆ¾",     pyNew:"ThÃ´-guÃ¢n",   pyOld:"Ngani/NgÃ¡-nÃ­"},
  "èŒ‚æ—":{old:"å¤šç´",     pyNew:"BÅo-lÃ®m",    pyOld:"TÅ-na"}
};

/* å››ç¾¤æŸ¥è©¢ */
function whichGroup(name){
  if(GROUPS.center.includes(name)) return 'center';
  if(GROUPS.east.includes(name))   return 'east';
  if(GROUPS.north.includes(name))  return 'north';
  if(GROUPS.mount.includes(name))  return 'mount';
  return null;
}

/* ---------- 3) ä¸»æµç¨‹ï¼šè¼‰å…¥ SVG â†’ æ¸…ç† â†’ ä¸Šè‰² â†’ ç¶å®šäº’å‹• ---------- */
const svgRoot = document.getElementById('svgRoot');
const stage = document.getElementById('stage');
const tip = document.getElementById('tip');

async function loadSVG(){
  const res = await fetch(SVG_URL, {mode:'cors'});
  const txt = await res.text();
  svgRoot.innerHTML = txt;

  // æ¸…æ‰è¦†è“‹å…¨åœ–çš„å¤§çŸ©å½¢ / é‚Šæ¡†
  const total = stage.viewBox.baseVal;
  const totalArea = total.width * total.height;
  svgRoot.querySelectorAll('rect,path,polygon').forEach(el=>{
    try{
      const bb = el.getBBox();
      const a = bb.width*bb.height;
      if(a/totalArea > 0.25 && !el.querySelector('title')) el.remove();
    }catch(e){}
  });

  // çµ¦æ¯å€‹è¡Œæ”¿å€ä¸Šè‰²ã€åŠ äº’å‹•
  const zones = svgRoot.querySelectorAll('path,polygon');
  zones.forEach(z=>{
    let t = z.querySelector('title');
    let n = (t && t.textContent ? t.textContent.trim() : '').replace(/å€.*$/,''); // å–ä¸­æ–‡å€åï¼ˆå»æ‰ã€Œå€â€¦ã€å°¾è¨»ï¼‰
    if(!n){ return; }

    const g = whichGroup(n);
    if(!g) return;

    // è‘—è‰² + hover
    z.classList.add('area-hover');
    z.setAttribute('fill', getComputedStyle(document.documentElement).getPropertyValue(
      {center:'--red',east:'--purple',north:'--ylg',mount:'--cyan'}[g]
    ).trim());
    z.setAttribute('stroke','#ffffff');
    z.setAttribute('stroke-width','1');

    // é»æ“Šæµ®çª—
    z.addEventListener('click', (ev)=>{
      ev.stopPropagation();
      const d = DATA[n];
      const bbox = z.getBBox();
      const cx = bbox.x + bbox.width/2;
      const cy = bbox.y + bbox.height/2;
      let html = '';
      if(d){
        html = `
          <h3>${n}</h3>
          <h4>${d.old}</h4>
          <p class="py">${d.pyNew}</p>
          <p class="py">${d.pyOld}</p>
          <div class="btns">
            <button class="btn" aria-disabled="true">â–¶ æ–°åœ°å</button>
            <button class="btn" aria-disabled="true">â–¶ èˆŠåœ°å</button>
          </div>`;
      }else{
        html = `<h3>${n}</h3><h4>ï¼ˆæš«ç„¡å°ç…§è³‡æ–™ï¼‰</h4>`;
      }
      tip.innerHTML = html;

      // è½‰ç•«é¢åº§æ¨™
      const pt = stage.createSVGPoint();
      pt.x = cx; pt.y = cy;
      const ctm = stage.getScreenCTM();
      const screen = pt.matrixTransform(ctm);
      const hostRect = stage.getBoundingClientRect();

      tip.style.left = (screen.x - hostRect.left) + 'px';
      tip.style.top  = (screen.y - hostRect.top - 8) + 'px';
      tip.classList.add('show');

      // é»å…¶ä»–åœ°æ–¹é—œé–‰
      const hide = ()=>{ tip.classList.remove('show'); window.removeEventListener('click', hide, true); };
      setTimeout(()=>window.addEventListener('click', hide, {once:true, capture:true}), 0);
    });
  });
}

/* è¼‰å…¥ */
loadSVG().catch(err=>{
  svgRoot.innerHTML = `<text x="20" y="40" fill="#b91c1c" font-size="16">è¼‰å…¥ SVG å¤±æ•—ï¼Œè«‹æª¢æŸ¥è·¯å¾‘ï¼š${SVG_URL}</text>`;
});
</script>
</body>
</html>
