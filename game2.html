<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8">
  <title>台語句子排序遊戲 - 測試版</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #f2f2f2;
    }
    h1 {
      margin-top: 20px;
    }
    #word-bank, #answer-area {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin: 10px auto;
      padding: 10px;
      min-height: 60px;
      background-color: #fff;
      border: 2px dashed #ccc;
      width: 80%;
    }
    .word {
      padding: 8px 12px;
      margin: 5px;
      background-color: #d9edf7;
      border: 1px solid #31708f;
      border-radius: 4px;
      cursor: move;
      user-select: none;
      text-align: center;
    }
    .controls {
      margin: 20px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
    }
    audio {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>台語句子排序遊戲</h1>

<div id="question">請將下列詞語排列成正確句子：</div>

<audio controls>
  <source src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/47/47743.mp3" type="audio/mp3">
  您的瀏覽器不支援音訊播放。
</audio>

<div class="controls">
  <button onclick="resetWords()">重新開始</button>
  <button onclick="checkAnswer()">確認</button>
  <button onclick="showAnswer()">提示正確答案</button>
  <a href="https://sutian.moe.edu.tw/und-hani/su/2144/" target="_blank">
    <button>看教典</button>
  </a>
</div>

<div id="word-bank"></div>
<div id="answer-area" ondragover="allowDrop(event)" ondrop="drop(event)"></div>

<div id="result" style="font-size: 18px; margin-top: 20px;"></div>

<script>
const correctAnswer = ["囡仔人", "有", "耳", "無", "喙", "。"];
let shuffled = [...correctAnswer].sort(() => Math.random() - 0.5);

function createWordElement(word) {
  const span = document.createElement("span");
  span.textContent = word;
  span.className = "word";
  span.draggable = true;
  span.ondragstart = drag;
  return span;
}

function populateWords() {
  const wordBank = document.getElementById("word-bank");
  wordBank.innerHTML = "";
  shuffled.forEach(word => {
    wordBank.appendChild(createWordElement(word));
  });

  const answerArea = document.getElementById("answer-area");
  answerArea.innerHTML = "";
}

function resetWords() {
  shuffled = [...correctAnswer].sort(() => Math.random() - 0.5);
  document.getElementById("result").textContent = "";
  populateWords();
}

function allowDrop(ev) {
  ev.preventDefault();
}

function drag(ev) {
  ev.dataTransfer.setData("text", ev.target.textContent);
}

function drop(ev) {
  ev.preventDefault();
  const text = ev.dataTransfer.getData("text");
  const wordBank = document.getElementById("word-bank");
  const answerArea = document.getElementById("answer-area");

  const wordElems = wordBank.getElementsByClassName("word");
  for (let i = 0; i < wordElems.length; i++) {
    if (wordElems[i].textContent === text) {
      const newElem = createWordElement(text);
      answerArea.appendChild(newElem);
      wordBank.removeChild(wordElems[i]);
      break;
    }
  }
}

function checkAnswer() {
  const answerArea = document.getElementById("answer-area");
  const words = Array.from(answerArea.getElementsByClassName("word")).map(w => w.textContent);
  const isCorrect = JSON.stringify(words) === JSON.stringify(correctAnswer);
  document.getElementById("result").textContent = isCorrect ? "✅ 正確！" : "❌ 錯誤，請再試試。";
}

function showAnswer() {
  const answerArea = document.getElementById("answer-area");
  const wordBank = document.getElementById("word-bank");
  answerArea.innerHTML = "";
  correctAnswer.forEach(word => {
    answerArea.appendChild(createWordElement(word));
  });
  wordBank.innerHTML = "";
  document.getElementById("result").textContent = "✅ 這是正確答案。";
}

window.onload = populateWords;
</script>

</body>
</html>
