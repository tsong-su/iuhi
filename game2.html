<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8" />
  <title>å°èªå­—è©æ’åºéŠæˆ²</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0;
      height: 100%;
      background-color: #fffae3; /* æ´»æ½‘äº®è‰²èƒŒæ™¯ */
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
      user-select: none;
    }
    h1 {
      margin-bottom: 0.5em;
      color: #2e7d32; /* ç¶ è‰² */
      text-align: center;
    }
    #instruction {
      font-size: 1.1em;
      margin-bottom: 1em;
      text-align: center;
    }
    #words, #answer-area {
      display: flex;
      justify-content: center;
      flex-wrap: nowrap; /* ä¸€åˆ—æ’åˆ— */
      gap: 10px;
      min-height: 50px;
      padding: 10px;
      background-color: #fff;
      border: 2px dashed #8bc34a;
      border-radius: 12px;
      margin-bottom: 20px;
      user-select: none;
    }
    .word {
      background-color: #aed581;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: grab;
      font-weight: 600;
      color: #2e7d32;
      user-select: none;
      white-space: nowrap;
      min-width: 40px;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px 8px;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #558b2f;
      color: white;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button:hover {
      background-color: #33691e;
    }
    #result {
      margin-top: 10px;
      font-weight: bold;
      font-size: 1.3em;
      min-height: 1.5em;
      color: #2e7d32;
      text-align: center;
      user-select: none;
    }
    #progress {
      width: 100%;
      max-width: 480px;
      height: 20px;
      background-color: #c5e1a5;
      border-radius: 10px;
      margin-bottom: 15px;
      overflow: hidden;
    }
    #progress-bar {
      height: 100%;
      width: 0%;
      background-color: #7cb342;
      transition: width 0.3s ease;
    }
    .link-btn {
      background-color: #4caf50;
      text-decoration: none;
      display: inline-block;
      margin-top: 12px;
      font-size: 14px;
      padding: 6px 12px;
      border-radius: 6px;
      color: white;
    }
    .link-btn:hover {
      background-color: #357a38;
    }
  </style>
</head>
<body>

  <h1>å°èªå­—è©æ’åºéŠæˆ²</h1>
  <div id="instruction">è½éŸ³æª”ï¼ŒkÄ tsia-Ãª å­—è© suÃ¡ hÅo å¥½å‹¢</div>

  <div id="progress">
    <div id="progress-bar"></div>
  </div>

  <div id="words"></div>

  <div style="text-align:center;">
    <button id="checkBtn">ç¢ºèª</button>
    <button id="restartBtn">é‡æ–°é–‹å§‹</button>
    <button id="nextBtn">å¾Œä¸€æ¢</button>
    <button id="hintBtn">æç¤ºæ­£ç¢ºç­”æ¡ˆ</button>
    <button id="playAudioBtn">ğŸ”Š æ’­éŸ³</button>
  </div>

  <div id="result"></div>

  <a href="index.html" class="link-btn">å›åˆ°éŠæˆ²é¦–é </a>
  <a href="#" target="_blank" id="dictLink" class="link-btn" style="margin-left:8px;">çœ‹æ•™å…¸</a>

  <audio id="audioPlayer" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script>
    const questions = [
      {
        words: ["å›¡ä»”äºº", "æœ‰", "è€³", "ç„¡", "å–™", "ã€‚"],
        answer: "å›¡ä»”äººæœ‰è€³ç„¡å–™ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/47/47743.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/2144/"
      },
      {
        words: ["é³¥ä»”", "ç”Ÿæˆ", "æœƒ", "é£›", "ï¼Œ", "äºº", "ç”Ÿæˆ", "æœƒ", "è¡Œè·¯", "ã€‚"],
        answer: "é³¥ä»”ç”Ÿæˆæœƒé£›ï¼Œäººç”Ÿæˆæœƒè¡Œè·¯ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/47/47451.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/1890/"
      },
      {
        words: ["ä¼Š", "æ˜¯", "ä¸€ä¸ª", "ç¬‘é¢è™", "ï¼Œ", "ä½ ", "è‘—æ„›", "æ³¨æ„", "ï¼"],
        answer: "ä¼Šæ˜¯ä¸€ä¸ªç¬‘é¢è™ï¼Œä½ è‘—æ„›æ³¨æ„ï¼",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/52/52341.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/6444/"
      },
      {
        words: ["å¹²ç„¦", "è³°", "é®çš„", "èœ", "çˆ¾çˆ¾", "ï¼Œ", "ä½ ", "æ¬²", "ç„¡", "ï¼Ÿ"],
        answer: "å¹²ç„¦è³°é®çš„èœçˆ¾çˆ¾ï¼Œä½ æ¬²ç„¡ï¼Ÿ",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/46/46044.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/448/"
      },
      {
        words: ["é£Ÿ", "æä»èŒ¶", "é…", "æ²¹ç‚¸ç²¿", "ã€‚"],
        answer: "é£Ÿæä»èŒ¶é…æ²¹ç‚¸ç²¿ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/50/50167.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/4283/"
      },
      {
        words: ["ä¸€é™£", "å›¡ä»”", "ä½‡é", "å’§", "æ©å’¯é›", "ã€‚"],
        answer: "ä¸€é™£å›¡ä»”ä½‡éå’§æ©å’¯é›ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/53/53291.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/7356/"
      },
      {
        words: ["ä¼Š", "æ‰", "æ¯‹æ˜¯", "å½¼æ¬¾", "æœƒ", "é£ŸéŒ¢", "çš„", "äºº", "ã€‚"],
        answer: "ä¼Šæ‰æ¯‹æ˜¯å½¼æ¬¾æœƒé£ŸéŒ¢çš„äººã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/51/51542.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/5674/"
      },
      {
        words: ["ä»Šä»”æ—¥", "çš„", "æ—¥é ­", "çœŸ", "çŒ›", "ã€‚"],
        answer: "ä»Šä»”æ—¥çš„æ—¥é ­çœŸçŒ›ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/46/46720.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/tshiau/?lui=tai_ku&tsha=%E4%BB%8A%E4%BB%94%E6%97%A5%E7%9A%84%E6%97%A5%E9%A0%AD%E7%9C%9F%E7%8C%9B"
      },
      {
        words: ["é€™é™£", "ç•¶å’§", "å‡º", "å¤§æ—¥è™", "ï¼Œ", "å’±", "ä¸Šå¥½", "è«", "å‡ºé–€", "ï¼Œ", "è¼ƒè¢‚", "è‘—ç—§", "ã€‚"],
        answer: "é€™é™£ç•¶å’§å‡ºå¤§æ—¥è™ï¼Œå’±ä¸Šå¥½è«å‡ºé–€ï¼Œè¼ƒè¢‚è‘—ç—§ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/wS/Jb/29207-1-1.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/29207/"
      },
      {
        words: ["è½", "éå¤§", "çš„", "é›¨", "é–£", "æ‹„è‘—", "æ»‡æµ", "ï¼Œ", "è«æ€ª", "æœƒ", "åšå¤§æ°´", "ã€‚"],
        answer: "è½éå¤§çš„é›¨é–£æ‹„è‘—æ»‡æµï¼Œè«æ€ªæœƒåšå¤§æ°´ã€‚",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/leku/61/61975.mp3",
        dict: "https://sutian.moe.edu.tw/und-hani/su/18989/"
      }
    ];

    let currentIndex = 0;
    let currentAnswer = "";
    const wordsContainer = document.getElementById('words');
    const resultDiv = document.getElementById('result');
    const progressBar = document.getElementById('progress-bar');
    const audioPlayer = document.getElementById('audioPlayer');
    const dictLink = document.getElementById('dictLink');

    // åˆå§‹åŒ–æ‹–æ›³åŠŸèƒ½
    let sortable = null;

    function shuffle(array) {
      const copy = [...array];
      for(let i = copy.length -1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function loadQuestion(index) {
      if(index < 0 || index >= questions.length) return;
      currentIndex = index;
      const q = questions[index];
      currentAnswer = q.answer;

      // æ¸…ç©ºä¸¦éš¨æ©Ÿæ’åˆ—å­—è©
      wordsContainer.innerHTML = "";
      let shuffledWords = shuffle(q.words);
      shuffledWords.forEach(word => {
        const div = document.createElement('div');
        div.className = 'word';
        div.textContent = word;
        wordsContainer.appendChild(div);
      });

      // æ›´æ–°æ‹–æ›³
      if(sortable) sortable.destroy();
      sortable = new Sortable(wordsContainer, {
        animation: 150,
        ghostClass: 'sortable-ghost',
        forceFallback: true,
        chosenClass: 'sortable-chosen',
        dragClass: 'sortable-drag'
      });

      // æ¸…ç©ºè¨Šæ¯
      resultDiv.textContent = "";
      updateProgressBar();
      // è¨­å®šæ•™å…¸é€£çµ
      dictLink.href = q.dict;

      // è‡ªå‹•æ’­æ”¾éŸ³æª”
      playAudio();
    }

    function updateProgressBar() {
      const percent = ((currentIndex + 1) / questions.length) * 100;
      progressBar.style.width = percent + '%';
    }

    function getUserAnswer() {
      return Array.from(wordsContainer.children).map(div => div.textContent).join('');
    }

    function checkAnswer() {
      const userAnswer = getUserAnswer();
      if(userAnswer === currentAnswer) {
        resultDiv.textContent = "âœ… è‘—ï¼æœ‰å¤ ğ ¢•ï¼";
        resultDiv.style.color = "green";
      } else {
        resultDiv.textContent = "æ¯‹è‘—å–”ï¼Œé–£è©¦ä¸€æ“ºã€‚";
        resultDiv.style.color = "red";
      }
    }

    function restart() {
      loadQuestion(currentIndex);
    }

    function nextQuestion() {
      let nextIdx = currentIndex + 1;
      if(nextIdx >= questions.length) nextIdx = 0;
      loadQuestion(nextIdx);
    }

    function showAnswer() {
      // æ¸…ç©ºå­—è©å€ï¼Œé¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆå­—è©ï¼ˆä¸éš¨æ©Ÿï¼‰
      wordsContainer.innerHTML = "";
      const correctWords = questions[currentIndex].words;
      correctWords.forEach(word => {
        const div = document.createElement('div');
        div.className = 'word';
        div.textContent = word;
        wordsContainer.appendChild(div);
      });

      if(sortable) sortable.destroy();
      sortable = new Sortable(wordsContainer, {
        animation: 150,
        disabled: true
      });

      resultDiv.textContent = "æ­£ç¢ºç­”æ¡ˆå·²æç¤º";
      resultDiv.style.color = "#2e7d32";
    }

    function playAudio() {
      const q = questions[currentIndex];
      audioPlayer.src = q.audio;
      audioPlayer.play().catch(() => {});
    }

    // æŒ‰éˆ•äº‹ä»¶ç¶å®š
    document.getElementById('checkBtn').addEventListener('click', checkAnswer);
    document.getElementById('restartBtn').addEventListener('click', restart);
    document.getElementById('nextBtn').addEventListener('click', nextQuestion);
    document.getElementById('hintBtn').addEventListener('click', showAnswer);
    document.getElementById('playAudioBtn').addEventListener('click', playAudio);

    // é é¢è¼‰å…¥æ™‚åˆå§‹é¡Œç›®
    loadQuestion(0);
  </script>

</body>
</html>
