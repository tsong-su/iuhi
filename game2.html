<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>台語字詞排序遊戲</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #FFF176;
      margin: 0;
      padding: 2em;
      text-align: center;
      color: #333;
    }

    h1 {
      font-size: 2em;
      color: #D84315;
    }

    #question {
      font-size: 1.5em;
      margin: 1em 0;
    }

    #words {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 1em 0;
      padding: 1em;
      border: 2px dashed #D84315;
      border-radius: 10px;
      background-color: #FFFDE7;
      min-height: 60px;
    }

    .word {
      padding: 0.5em 1em;
      margin: 0.5em;
      background-color: #FFB74D;
      border-radius: 8px;
      cursor: grab;
      font-size: 1.2em;
    }

    button {
      padding: 0.6em 1.2em;
      margin: 0.5em;
      font-size: 1em;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    #checkBtn {
      background-color: #4CAF50;
      color: white;
    }

    #nextBtn {
      background-color: #29B6F6;
      color: white;
    }

    #restartBtn {
      background-color: #FF9800;
      color: white;
    }

    #hintBtn {
      background-color: #9C27B0;
      color: white;
    }

    #homeBtn {
      background-color: #607D8B;
      color: white;
    }

    #result {
      font-size: 1.3em;
      margin-top: 1em;
    }

    a.dictionary-link {
      display: inline-block;
      margin-top: 1em;
      text-decoration: none;
      color: #1E88E5;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>台語字詞排序遊戲</h1>
  <div id="question">請kā tsia-ê 字詞排hōo 好勢：</div>
  <div id="words"></div>
  <button id="checkBtn">確認</button>
  <button id="nextBtn">後一條</button>
  <button id="restartBtn">重新開始</button>
  <button id="hintBtn">提示正確答案</button>
  <button id="homeBtn" onclick="window.location.href='index.html'">回到遊戲首頁</button>
  <div id="result"></div>
  <a id="dictLink" class="dictionary-link" href="#" target="_blank">查教典</a>

  <!-- 音效播放器 -->
  <audio id="correctSound" preload="auto" src="https://cdn.pixabay.com/audio/2022/03/15/audio_91e1ad5c4b.mp3"></audio>
  <audio id="wrongSound" preload="auto" src="https://cdn.pixabay.com/audio/2022/03/15/audio_4c2cde7d52.mp3"></audio>

  <script>
    const questions = [
      {
        words: ["鳥仔", "生成", "會", "飛", "，", "人", "生成", "會", "行路", "。"],
        answer: "鳥仔生成會飛，人生成會行路。",
        dictLink: "https://twblg.dict.edu.tw/holodict_new/result.jsp?n_no=43147&curpage=1&sample=%E8%A1%8C%E8%B7%AF"
      },
      {
        words: ["我", "欲", "去", "迌", "。"],
        answer: "我欲去迌。",
        dictLink: "https://twblg.dict.edu.tw/holodict_new/result.jsp?n_no=1310&curpage=1&sample=%E8%BF%8C"
      }
      // 可繼續擴充更多題
    ];

    let currentQuestion = 0;
    let currentAnswer = "";

    const wordsContainer = document.getElementById("words");
    const resultDiv = document.getElementById("result");
    const dictLink = document.getElementById("dictLink");

    const correctSound = document.getElementById("correctSound");
    const wrongSound = document.getElementById("wrongSound");

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function loadQuestion() {
      resultDiv.textContent = "";
      const q = questions[currentQuestion];
      currentAnswer = q.answer;
      dictLink.href = q.dictLink;

      wordsContainer.innerHTML = "";
      const shuffledWords = shuffle([...q.words]);

      shuffledWords.forEach(word => {
        const span = document.createElement("span");
        span.className = "word";
        span.draggable = true;
        span.textContent = word;
        wordsContainer.appendChild(span);
      });

      enableDrag();
    }

    function enableDrag() {
      let dragged;

      document.querySelectorAll(".word").forEach(el => {
        el.addEventListener("dragstart", e => {
          dragged = el;
          e.dataTransfer.effectAllowed = "move";
        });

        el.addEventListener("dragover", e => {
          e.preventDefault();
        });

        el.addEventListener("drop", e => {
          e.preventDefault();
          if (dragged !== e.target) {
            const words = Array.from(wordsContainer.children);
            const from = words.indexOf(dragged);
            const to = words.indexOf(e.target);
            if (from < to) {
              wordsContainer.insertBefore(dragged, e.target.nextSibling);
            } else {
              wordsContainer.insertBefore(dragged, e.target);
            }
          }
        });
      });
    }

    function getUserAnswer() {
      return Array.from(wordsContainer.children).map(el => el.textContent).join("");
    }

    function checkAnswer() {
      const userAnswer = getUserAnswer();
      if (userAnswer === currentAnswer) {
        resultDiv.textContent = "✅ 著！有夠𠢕！";
        resultDiv.style.color = "green";
        correctSound.play();
      } else {
        resultDiv.textContent = "毋著喔，閣試一擺。";
        resultDiv.style.color = "red";
        wrongSound.play();
      }
    }

    document.getElementById("checkBtn").addEventListener("click", checkAnswer);

    document.getElementById("nextBtn").addEventListener("click", () => {
      currentQuestion = (currentQuestion + 1) % questions.length;
      loadQuestion();
    });

    document.getElementById("restartBtn").addEventListener("click", () => {
      loadQuestion();
    });

    document.getElementById("hintBtn").addEventListener("click", () => {
      resultDiv.textContent = `提示：${currentAnswer}`;
      resultDiv.style.color = "#FF5722";
    });

    window.addEventListener("load", loadQuestion);
  </script>
</body>
</html>
