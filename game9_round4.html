<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8">
<title>果子圖片&台語果子名配對 第四回</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #fffbe6;
    text-align: center;
  }
  h1 {
    margin-top: 10px;
    font-size: 1.5em;
  }
  .note {
    margin: 5px 0 10px 0;
    font-size: 1.2em;
    color: #ff4500;
  }
  .game-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 5px;
    padding: 5px;
  }
  .grid-item {
    width: 23%;
    max-width: 100px;
    height: 100px;
    background: #f2f2f2;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2em;
    cursor: pointer;
    user-select: none;
    border-radius: 8px;
    box-sizing: border-box;
  }
  .grid-item img {
    max-width: 100%;
    max-height: 100%;
  }
  .button-container {
    margin: 15px 0;
  }
  .btn {
    padding: 10px 15px;
    margin: 5px;
    font-size: 1em;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    color: #fff;
  }
  .play-again {background-color: #f08080;}
  .next-round {background-color: #6a5acd;}
  .home {background-color: #20b2aa;}
</style>
</head>
<body>
<h1>果子圖片&台語果子名配對 第四回</h1>
<div class="note">📱 建議直式觀看效果最佳</div>

<div id="image-grid" class="game-container"></div>
<div id="word-grid" class="game-container"></div>

<div class="button-container">
  <button class="btn play-again" onclick="restartGame()">閣耍一擺</button>
  <button class="btn next-round" onclick="nextRound()">後一回</button>
  <button class="btn home" onclick="goHome()">轉去遊戲頭頁</button>
</div>

<audio id="audioCorrect"></audio>
<audio id="audioWrong" src="game9_assets/wrong1.mp3"></audio>
<audio id="audioVictory" src="game9_assets/victory2.mp3"></audio>

<script>
const fruitsRound4 = [
  {id: "fruit10", name: "柳丁", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5078.mp3", img:"game9_assets/fruit10.png", color:"#FFB347"},
  {id: "fruit11", name: "木瓜", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/877.mp3", img:"game9_assets/fruit11.png", color:"#FFD700"},
  {id: "fruit12", name: "梨仔", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7478.mp3", img:"game9_assets/fruit12.png", color:"#ADFF2F"},
  {id: "fruit13", name: "棗仔", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8491.mp3", img:"game9_assets/fruit13.png", color:"#FF69B4"},
  {id: "fruit14", name: "柚仔", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5085.mp3", img:"game9_assets/fruit14.png", color:"#87CEFA"},
  {id: "fruit16", name: "柿仔", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5087.mp3", img:"game9_assets/fruit16.png", color:"#FF6347"},
  {id: "fruit17", name: "荔枝", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6646.mp3", img:"game9_assets/fruit17.png", color:"#EE82EE"},
  {id: "fruit34", name: "臭柿仔", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6575.mp3", img:"game9_assets/fruit34.png", color:"#40E0D0"}
];

let selectedImage = null;
let selectedWord = null;

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function initGame() {
  const imageGrid = document.getElementById('image-grid');
  const wordGrid = document.getElementById('word-grid');
  imageGrid.innerHTML = '';
  wordGrid.innerHTML = '';

  const shuffledImages = shuffle([...fruitsRound4]);
  const shuffledWords = shuffle([...fruitsRound4]);

  shuffledImages.forEach(fruit => {
    const div = document.createElement('div');
    div.className = 'grid-item';
    const img = document.createElement('img');
    img.src = fruit.img;
    img.alt = fruit.name;
    div.appendChild(img);
    div.dataset.id = fruit.id;
    div.onclick = () => selectImage(div, fruit);
    imageGrid.appendChild(div);
  });

  shuffledWords.forEach(fruit => {
    const div = document.createElement('div');
    div.className = 'grid-item';
    div.textContent = fruit.name;
    div.dataset.id = fruit.id;
    div.style.fontSize = '1em';
    div.onclick = () => selectWord(div, fruit);
    wordGrid.appendChild(div);
  });
}

function selectImage(div, fruit) {
  if(selectedImage) selectedImage.style.border = '';
  selectedImage = div;
  div.style.border = '2px solid #000';
  checkMatch();
}

function selectWord(div, fruit) {
  if(selectedWord) selectedWord.style.border = '';
  selectedWord = div;
  div.style.border = '2px solid #000';
  checkMatch();
}

function checkMatch() {
  if(selectedImage && selectedWord) {
    if(selectedImage.dataset.id === selectedWord.dataset.id) {
      const color = fruitsRound4.find(f => f.id === selectedImage.dataset.id).color;
      selectedImage.style.background = color;
      selectedWord.style.background = color;
      playAudio(fruitsRound4.find(f => f.id === selectedImage.dataset.id).audio);
      selectedImage.onclick = null;
      selectedWord.onclick = null;
      selectedImage.style.border = '';
      selectedWord.style.border = '';
      selectedImage = null;
      selectedWord = null;
      if(document.querySelectorAll('#image-grid .grid-item[onclick]').length === 0) {
        setTimeout(() => document.getElementById('audioVictory').play(), 1000);
      }
    } else {
      document.getElementById('audioWrong').play();
      setTimeout(() => {
        if(selectedImage) selectedImage.style.border = '';
        if(selectedWord) selectedWord.style.border = '';
        selectedImage = null;
        selectedWord = null;
      }, 500);
    }
  }
}

function playAudio(url) {
  const audio = document.getElementById('audioCorrect');
  audio.src = url;
  audio.play();
}

function restartGame() {
  initGame();
}

function nextRound() {
  alert('這是最後一回囉！');
}

function goHome() {
  window.location.href = 'game9.html';
}

window.onload = initGame;
</script>
</body>
</html>
