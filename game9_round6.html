<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>果子骰仔遊戲-第2回</title>
<style>
  body { font-family: Arial, sans-serif; background-color: #fff8f0; margin:0; padding:0; text-align:center; }
  h1 { color: #d35400; margin-top: 10px; }
  #dice-container { perspective: 800px; width: 200px; height: 200px; margin: 30px auto; }
  #dice { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 1s ease-out; }
  .face {
    position: absolute;
    width: 200px;
    height: 200px;
    border: 4px solid #e67e22;
    border-radius: 12px;
    backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    background-color: #fff;
  }
  #face1 { transform: rotateY(0deg) translateZ(100px); }
  #face2 { transform: rotateY(90deg) translateZ(100px); }
  #face3 { transform: rotateY(180deg) translateZ(100px); }
  #face4 { transform: rotateY(-90deg) translateZ(100px); }
  #face5 { transform: rotateX(90deg) translateZ(100px); }
  #face6 { transform: rotateX(-90deg) translateZ(100px); }
  button { margin: 15px; padding: 10px 20px; font-size: 16px; border-radius: 8px; border:none; background-color:#f39c12; color:#fff; cursor:pointer; }
  #message { margin-top: 15px; font-size: 20px; color:#2c3e50; }
  #advice { font-size: 14px; color:#7f8c8d; margin-top:5px; }
</style>
</head>
<body>

<h1>果子骰仔遊戲-第2回</h1>
<div id="advice">📱建議直式觀看效果最佳</div>

<div id="dice-container">
  <div id="dice">
    <div class="face" id="face1"></div>
    <div class="face" id="face2"></div>
    <div class="face" id="face3"></div>
    <div class="face" id="face4"></div>
    <div class="face" id="face5"></div>
    <div class="face" id="face6"></div>
  </div>
</div>

<button id="rollBtn">擲骰子</button>
<div id="message"></div>
<button onclick="location.href='game9_round7.html'">後一回</button>

<audio id="rollSound" src="game9_assets/Roll the dice.mp3"></audio>
<audio id="dingSound" src="game9_assets/ding.mp3"></audio>

<script>
const dice = document.getElementById('dice');
const rollBtn = document.getElementById('rollBtn');
const message = document.getElementById('message');

const fruits = [
  {img:'game9_assets/fruit7.png', name:'芳瓜', pinyin:'phang-kue', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4434.mp3'},
  {img:'game9_assets/fruit8.png', name:'葡萄', pinyin:'phû-tô', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9985.mp3'},
  {img:'game9_assets/fruit9.png', name:'蓮霧', pinyin:'lián-bū', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3'},
  {img:'game9_assets/fruit10.png', name:'柳丁', pinyin:'liú-ting', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5078.mp3'},
  {img:'game9_assets/fruit11.png', name:'木瓜', pinyin:'bo̍k-kue', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/877.mp3'},
  {img:'game9_assets/fruit12.png', name:'梨仔', pinyin:'lâi-á', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7478.mp3'}
];

// 設定骰子面
const faces = [];
for(let i=1;i<=6;i++){
  const f = document.getElementById('face'+i);
  f.style.backgroundImage = `url(${fruits[i-1].img})`;
  f.style.backgroundSize = 'contain';
  f.style.backgroundRepeat = 'no-repeat';
  f.style.backgroundPosition = 'center';
  faces.push(f);
}

// 擲骰子
rollBtn.addEventListener('click', async () => {
  rollBtn.disabled = true;
  message.textContent = '';
  const rollSound = document.getElementById('rollSound');
  const dingSound = document.getElementById('dingSound');

  // 播放滾動音效
  await rollSound.play().catch(()=>{});

  // 隨機水果
  const index = Math.floor(Math.random()*fruits.length);

  // 旋轉骰子動畫 (隨機旋轉)
  const xRot = 720 + Math.floor(Math.random()*360);
  const yRot = 720 + Math.floor(Math.random()*360);
  dice.style.transform = `rotateX(${xRot}deg) rotateY(${yRot}deg)`;

  // 等待動畫結束
  setTimeout(async ()=>{
    // 播放停止音效
    await dingSound.play().catch(()=>{});
    // 播放水果音檔
    const fruitAudio = new Audio(fruits[index].audio);
    await fruitAudio.play().catch(()=>{});
    message.textContent = `${fruits[index].name} ${fruits[index].pinyin}`;
    rollBtn.disabled = false;
  },1200); // 1.2秒與 CSS transition 時間一致
});
</script>

</body>
</html>
