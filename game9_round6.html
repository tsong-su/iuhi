<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>果子骰仔遊戲-第2回</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --roll-btn: #ff6b35;
  --again-btn: #4caf50;
  --next-btn: #2196f3;
  --home-btn: #9c27b0;
  --bg1: #fffbea;
  --cube-border-color: #c74444;
  --cube-border: 6px solid var(--cube-border-color);
  --cube-border-radius: 12px;
}
*{ box-sizing:border-box; }
body{
  margin:0; min-height:100vh; font-family:"Noto Sans TC","Microsoft JhengHei",sans-serif;
  background:var(--bg1); display:flex; flex-direction:column; align-items:center;
  color:#222;
}
header{ text-align:center; padding:14px 10px 4px; width:100%; }
h1{ margin:0; font-size:6.5vw; color:#d94f4f; line-height:1; }
.hint{ margin-top:8px; font-size:4.8vw; color:#ff6600; font-weight:700; }

main{ width:100%; max-width:520px; padding:8px 12px 18px; display:flex; flex-direction:column; align-items:center; gap:8px; flex:1 1 auto; }

.cube-wrap{ width:100%; display:flex; justify-content:center; align-items:center; }
.cube-stage{
  width: min(90vw, 200px);
  height: min(90vw, 200px);
  max-width:200px;
  max-height:200px;
  perspective:1200px;
  display:flex; align-items:center; justify-content:center;
}

.cube {
  width: var(--cube-size);
  height: var(--cube-size);
  position:relative;
  transform-style:preserve-3d;
  transition: transform 1800ms cubic-bezier(.19,.57,.3,.98);
}

.face{
  position:absolute; left:0; top:0;
  width:100%; height:100%;
  border-radius:var(--cube-border-radius);
  overflow:hidden;
  display:flex; align-items:center; justify-content:center;
  background:#fff; box-shadow: 0 12px 22px rgba(0,0,0,0.12), inset 0 0 0 2px rgba(0,0,0,0.02);
  border:var(--cube-border);
  backface-visibility:hidden;
}
.face img{ width:92%; height:92%; object-fit:contain; display:block; border-radius:8px; }

.face.front  { transform: rotateY(0deg)    translateZ(calc(var(--cube-size)/2)); }
.face.back   { transform: rotateY(180deg)  translateZ(calc(var(--cube-size)/2)); }
.face.right  { transform: rotateY(90deg)   translateZ(calc(var(--cube-size)/2)); }
.face.left   { transform: rotateY(-90deg)  translateZ(calc(var(--cube-size)/2)); }
.face.top    { transform: rotateX(90deg)   translateZ(calc(var(--cube-size)/2)); }
.face.bottom { transform: rotateX(-90deg)  translateZ(calc(var(--cube-size)/2)); }

#result {
  width:100%; min-height:120px; display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:8px;
}
.fruit-name{ font-size:6.5vw; color:#ff4081; font-weight:800; line-height:1; }
.fruit-roman{ font-size:5vw; color:#009688; font-weight:700; margin-top:4px; }
.play-audio{
  margin-top:8px; padding:8px 18px; border-radius:12px; border:none; background:#3f51b5; color:#fff; font-weight:700;
  font-size:4.6vw; cursor:pointer;
}

.controls{ display:flex; gap:8px; justify-content:center; align-items:center; width:100%; margin-top:6px; }
#rollBtn{
  background:var(--roll-btn); color:#fff; border:none; border-radius:12px; padding:12px 20px; font-weight:800;
  font-size:5.2vw; cursor:pointer; box-shadow: 0 8px 20px rgba(0,0,0,0.12);
}

.bottom{ width:100%; padding:12px 10px 22px; display:flex; justify-content:center; gap:10px; }
.bottom button{ border:none; padding:10px 12px; border-radius:12px; color:#fff; font-weight:800; cursor:pointer; font-size:4.6vw; }
#againBtn{ background:var(--again-btn) }
#nextBtn{ background:var(--next-btn) }
#homeBtn{ background:var(--home-btn) }

@media(min-width:720px){
  h1{ font-size:28px } .hint{ font-size:16px } .fruit-name{ font-size:28px } .fruit-roman{ font-size:18px }
  #rollBtn{ font-size:16px } .play-audio{ font-size:14px } .bottom button{ font-size:14px }
}
</style>
</head>
<body>
<header>
  <h1>果子骰仔遊戲-第2回</h1>
  <div class="hint">📱 建議直式觀看效果最佳</div>
</header>

<main>
  <div class="cube-wrap">
    <div class="cube-stage" id="stage">
      <div id="cube" class="cube" aria-hidden="false" role="img" aria-label="果子骰子" style="transform: rotateX(0deg) rotateY(0deg);">
        <div class="face front"><img src="game9_assets/fruit1.png" alt="檨仔"></div>
        <div class="face back"><img src="game9_assets/fruit2.png" alt="柑仔"></div>
        <div class="face right"><img src="game9_assets/fruit3.png" alt="弓蕉"></div>
        <div class="face left"><img src="game9_assets/fruit4.png" alt="林菝仔"></div>
        <div class="face top"><img src="game9_assets/fruit5.png" alt="王梨"></div>
        <div class="face bottom"><img src="game9_assets/fruit6.png" alt="時計果"></div>
      </div>
    </div>
  </div>

  <div class="controls">
    <button id="rollBtn">撚骰仔 🎲</button>
  </div>

  <div id="result">
    <div class="fruit-name" id="fruitName">&nbsp;</div>
    <div class="fruit-roman" id="fruitRoman">&nbsp;</div>
    <button id="playPron" class="play-audio" style="display:none">🔊 聽台語發音</button>
  </div>
</main>

<div class="bottom">
  <button id="againBtn">閣耍一擺</button>
  <button id="nextBtn">後一回</button>
  <button id="homeBtn">轉去遊戲頭頁</button>
</div>

<audio id="rollSound" preload="auto"></audio>
<audio id="dingSound" preload="auto"></audio>
<audio id="fruitSound" preload="auto"></audio>

<script>
/* ---------- 水果資料 ---------- */
const fruits = [
  { name: "檨仔", roman: "suāinn-á", img: "game9_assets/fruit1.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12189.mp3" },
  { name: "柑仔", roman: "kam-á",   img: "game9_assets/fruit2.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5084.mp3" },
  { name: "弓蕉", roman: "king-tsio",img: "game9_assets/fruit3.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/529.mp3" },
  { name: "林菝仔",roman: "ná-pua̍t-á",img:"game9_assets/fruit4.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4237.mp3" },
  { name: "王梨", roman: "ông-lâi", img: "game9_assets/fruit5.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3373.mp3" },
  { name: "時計果", roman: "si-ki-kó", img:"game9_assets/fruit6.png", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8291.mp3" },
  { name: "柳丁", roman: "liú-ting", img:"game9_assets/fruit10.png", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5078.mp3" },
  { name: "木瓜", roman: "bo̍k-kue", img:"game9_assets/fruit11.png", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/877.mp3" },
  { name: "梨仔", roman: "lâi-á", img:"game9_assets/fruit12.png", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7478.mp3" }
];

/* ---------- DOM ---------- */
const cube = document.getElementById("cube");
const rollBtn = document.getElementById("rollBtn");
const fruitName = document.getElementById("fruitName");
const fruitRoman = document.getElementById("fruitRoman");
const playPron = document.getElementById("playPron");
const rollSound = document.getElementById("rollSound");
const dingSound = document.getElementById("dingSound");
const fruitSound = document.getElementById("fruitSound");

/* ---------- 音效檔 ---------- */
rollSound.src = "game9_assets/Roll the dice.mp3";
dingSound.src = "game9_assets/ding.mp3";

/* ---------- 隨機六面水果 ---------- */
function randomFruits6(){
  const shuffled = fruits.sort(()=>0.5-Math.random());
  return shuffled.slice(0,6);
}

/* ---------- 骰子旋轉 ---------- */
function rollDice(){
  const faces = randomFruits6();
  const angleX = Math.floor(Math.random()*4)*90 + 720;
  const angleY = Math.floor(Math.random()*4)*90 + 720;

  // 更新六面圖片
  const faceDivs = cube.querySelectorAll(".face");
  faceDivs.forEach((face,i)=>{
    face.querySelector("img").src = faces[i].img;
    face.querySelector("img").alt = faces[i].name;
  });

  // 播放擲骰子聲
  rollSound.currentTime=0;
  rollSound.play();

  cube.style.transition="transform 1800ms cubic-bezier(.19,.57,.3,.98)";
  cube.style.transform=`rotateX(${angleX}deg) rotateY(${angleY}deg)`;

  // 結束後播放 ding → 正確水果
  setTimeout(()=>{
    rollSound.pause();
    dingSound.currentTime=0;
    dingSound.play();

    dingSound.onended = ()=>{
      const topFruit = faces[0];
      fruitName.textContent = topFruit.name;
      fruitRoman.textContent = topFruit.roman;
      fruitSound.src = topFruit.audio;
      fruitSound.play();
      playPron.style.display="inline-block";
      playPron.onclick = ()=>{ fruitSound.currentTime=0; fruitSound.play(); };
    }
  },1800);
}

/* ---------- 控制 ---------- */
rollBtn.addEventListener("click", rollDice);
document.getElementById("againBtn").addEventListener("click", ()=>{
  fruitName.innerHTML="&nbsp;"; fruitRoman.innerHTML="&nbsp;"; playPron.style.display="none";
  cube.style.transition="none"; cube.style.transform="rotateX(0deg) rotateY(0deg)";
});
document.getElementById("nextBtn").addEventListener("click", ()=>{ location.href="game9_round6.html"; });
document.getElementById("homeBtn").addEventListener("click", ()=>{ location.href="index.html"; });

</script>
</body>
</html>
