<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>果子骰仔遊戲－第2回</title>
<style>
  body { font-family: "Microsoft JhengHei", sans-serif; margin:0; padding:0; background:#fff; color:#333; text-align:center; }
  h1 { color:#5a2d6e; margin:10px 0; }
  .cube-wrap{ width:100%; display:flex; justify-content:center; align-items:center; }
  .cube-stage{
    width: min(90vw, 200px);
    height: min(90vw, 200px);
    max-width:200px;
    max-height:200px;
    perspective:1200px;
    margin:20px auto;
  }
  .cube{
    width:100%;
    height:100%;
    position:relative;
    transform-style: preserve-3d;
    transform: rotateX(0deg) rotateY(0deg);
    transition: transform 1s;
    border: 3px solid #5a2d6e; /* 保持第1回邊框色系 */
    border-radius:10px;
    box-sizing:border-box;
  }
  .cube-face{
    position:absolute;
    width:100%;
    height:100%;
    backface-visibility:hidden;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:1.2em;
    font-weight:bold;
    color:#000;
  }
  .cube-face img{ max-width:80%; max-height:80%; }
  button{
    margin:10px 5px; padding:8px 16px; font-size:16px;
    border:none; border-radius:8px; cursor:pointer;
    background-color:#5a2d6e; color:#fff;
  }
  button:hover{ background-color:#7a3f8a; }
</style>
</head>
<body>
<h1>果子骰仔遊戲－第2回</h1>
<p>📱 建議直式觀看效果最佳</p>
<div class="cube-wrap">
  <div class="cube-stage">
    <div class="cube" id="dice">
      <div class="cube-face" data-fruit="fruit7"><img src="game9_assets/fruit7.png" alt="芳瓜"></div>
      <div class="cube-face" data-fruit="fruit8"><img src="game9_assets/fruit8.png" alt="葡萄"></div>
      <div class="cube-face" data-fruit="fruit9"><img src="game9_assets/fruit9.png" alt="蓮霧"></div>
      <div class="cube-face" data-fruit="fruit10"><img src="game9_assets/fruit10.png" alt="柳丁"></div>
      <div class="cube-face" data-fruit="fruit11"><img src="game9_assets/fruit11.png" alt="木瓜"></div>
      <div class="cube-face" data-fruit="fruit12"><img src="game9_assets/fruit12.png" alt="梨仔"></div>
    </div>
  </div>
</div>
<p id="fruit-name" style="font-size:1.2em; font-weight:bold;"></p>
<button id="roll-btn">撚骰仔 🎲</button>
<button id="retry-btn">閣耍一擺</button>
<button onclick="location.href='index.html'">轉去遊戲頭頁</button>
<button onclick="location.href='game9_round7.html'">後一回</button>

<audio id="roll-sound" src="game9_assets/Roll the dice.mp3"></audio>
<audio id="stop-sound" src="game9_assets/ding.mp3"></audio>
<audio id="fruit7-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4434.mp3"></audio>
<audio id="fruit8-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9985.mp3"></audio>
<audio id="fruit9-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3"></audio>
<audio id="fruit10-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5078.mp3"></audio>
<audio id="fruit11-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/877.mp3"></audio>
<audio id="fruit12-audio" src="https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7478.mp3"></audio>

<script>
const cube = document.getElementById('dice');
const rollBtn = document.getElementById('roll-btn');
const retryBtn = document.getElementById('retry-btn');
const fruitName = document.getElementById('fruit-name');

const fruits = [
  {id:'fruit7', name:'芳瓜', pinyin:'phang-kue', audio:document.getElementById('fruit7-audio')},
  {id:'fruit8', name:'葡萄', pinyin:'phû-tô', audio:document.getElementById('fruit8-audio')},
  {id:'fruit9', name:'蓮霧', pinyin:'lián-bū', audio:document.getElementById('fruit9-audio')},
  {id:'fruit10', name:'柳丁', pinyin:'liú-ting', audio:document.getElementById('fruit10-audio')},
  {id:'fruit11', name:'木瓜', pinyin:'bo̍k-kue', audio:document.getElementById('fruit11-audio')},
  {id:'fruit12', name:'梨仔', pinyin:'lâi-á', audio:document.getElementById('fruit12-audio')}
];

let currentFruit = null;
let rolling = false;

function getRandomFruit(){
  const remaining = fruits.filter(f=>f!==currentFruit);
  const choice = remaining[Math.floor(Math.random()*remaining.length)];
  currentFruit = choice;
  return choice;
}

function rollDice(){
  if(rolling) return;
  rolling = true;
  fruitName.textContent = '';
  const fruit = getRandomFruit();

  document.getElementById('roll-sound').currentTime=0;
  document.getElementById('roll-sound').play();

  // 隨機旋轉 3D
  const xRotate = 720 + Math.floor(Math.random()*720);
  const yRotate = 720 + Math.floor(Math.random()*720);
  cube.style.transform = `rotateX(${xRotate}deg) rotateY(${yRotate}deg)`;

  setTimeout(()=>{
    document.getElementById('roll-sound').pause();
    document.getElementById('stop-sound').currentTime=0;
    document.getElementById('stop-sound').play();

    setTimeout(()=>{
      fruitName.textContent = fruit.name + ' ' + fruit.pinyin;
      fruit.audio.currentTime = 0;
      fruit.audio.play();
      rolling=false;
    }, 500);
  }, 1000);
}

rollBtn.addEventListener('click', rollDice);
retryBtn.addEventListener('click', rollDice);
</script>
</body>
</html>
