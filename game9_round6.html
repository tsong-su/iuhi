<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8">
<title>果子骰仔遊戲-第2回</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #fff8e7;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin-top: 20px;
    font-size: 36px;
    color: #ff6600;
  }
  #dice-container {
    width: 200px;
    height: 200px;
    margin: 40px auto;
    perspective: 600px;
  }
  .cube {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 1s ease-out;
  }
  .face {
    position: absolute;
    width: 200px;
    height: 200px;
    border: 2px solid #333;
    border-radius: 12px;
    background-size: cover;
    background-position: center;
  }
  .face1 { transform: rotateY(0deg) translateZ(100px); }
  .face2 { transform: rotateY(90deg) translateZ(100px); }
  .face3 { transform: rotateY(180deg) translateZ(100px); }
  .face4 { transform: rotateY(-90deg) translateZ(100px); }
  .face5 { transform: rotateX(90deg) translateZ(100px); }
  .face6 { transform: rotateX(-90deg) translateZ(100px); }

  #buttons {
    margin-top: 30px;
  }
  button {
    font-size: 18px;
    padding: 10px 20px;
    margin: 10px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background-color: #ff9966;
    color: #fff;
  }
  #fruit-name {
    margin-top: 20px;
    font-size: 28px;
    color: #333;
  }
</style>
</head>
<body>

<h1>果子骰仔遊戲-第2回</h1>

<div id="dice-container">
  <div class="cube" id="cube">
    <div class="face face1"></div>
    <div class="face face2"></div>
    <div class="face face3"></div>
    <div class="face face4"></div>
    <div class="face face5"></div>
    <div class="face face6"></div>
  </div>
</div>

<div id="fruit-name"></div>

<div id="buttons">
  <button id="rollBtn">擲骰</button>
  <button onclick="location.href='https://tsong-su.github.io/iuhi/index.html'">轉去遊戲頭頁</button>
  <button onclick="location.href='game9_round7.html'">後一回</button>
</div>

<audio id="rollSound" src="game9_assets/Roll the dice.mp3"></audio>
<audio id="dingSound" src="game9_assets/ding.mp3"></audio>

<script>
const cube = document.getElementById('cube');
const rollBtn = document.getElementById('rollBtn');
const fruitName = document.getElementById('fruit-name');
const rollSound = document.getElementById('rollSound');
const dingSound = document.getElementById('dingSound');

// 六種水果資料
const fruits = [
  {img:'game9_assets/fruit7.png', name:'芳瓜', pinyin:'phang-kue', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4434.mp3'},
  {img:'game9_assets/fruit8.png', name:'葡萄', pinyin:'phû-tô', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9985.mp3'},
  {img:'game9_assets/fruit9.png', name:'蓮霧', pinyin:'lián-bū', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11322.mp3'},
  {img:'game9_assets/fruit10.png', name:'柳丁', pinyin:'liú-ting', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5078.mp3'},
  {img:'game9_assets/fruit11.png', name:'木瓜', pinyin:'bo̍k-kue', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/877.mp3'},
  {img:'game9_assets/fruit12.png', name:'梨仔', pinyin:'lâi-á', audio:'https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7478.mp3'}
];

// 隨機順序生成六種水果不重複
function shuffle(array) {
  let arr = array.slice();
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

let sequence = shuffle(fruits);
let current = 0;

rollBtn.addEventListener('click', () => {
  if(current >= sequence.length) {
    fruitName.textContent = '本回已完成所有水果！';
    return;
  }

  rollBtn.disabled = true;
  fruitName.textContent = '';
  
  // 播放骰子滾動音效
  rollSound.currentTime = 0;
  rollSound.play();

  // 旋轉骰子動畫
  let randX = 720 + Math.floor(Math.random() * 360);
  let randY = 720 + Math.floor(Math.random() * 360);
  cube.style.transform = `rotateX(${randX}deg) rotateY(${randY}deg)`;

  // 等滾動音效結束再播放水果音效
  rollSound.onended = () => {
    const fruit = sequence[current];
    // 播放停止音效
    dingSound.currentTime = 0;
    dingSound.play();
    // 顯示水果名稱與拼音
    fruitName.textContent = `${fruit.name} ${fruit.pinyin}`;
    // 播放水果音檔
    let fruitAudio = new Audio(fruit.audio);
    fruitAudio.play();
    current++;
    rollBtn.disabled = false;
  };
});
</script>

</body>
</html>
