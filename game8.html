<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>å’±ä¾†æ’šéª°ä»”</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      text-align: center;
      margin: 0;
      background: #f8f8f8;
      overflow-x: hidden;
    }
    h1 {
      margin: 10px 0;
      font-size: 2.2em;
      background: linear-gradient(90deg, #ff7b00, #ff0066);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    #controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin: 10px 0;
      flex-wrap: wrap;
    }
    button {
      padding: 8px 14px;
      font-size: 1em;
      border: none;
      border-radius: 6px;
      background: #ff9800;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #e68900;
    }
    select {
      padding: 5px;
      font-size: 1em;
    }
    #instructionBox {
      position: absolute;
      top: 65px;
      left: 10px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid #ccc;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.9em;
      text-align: left;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    #dice-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      margin: 15px auto;
      gap: 12px;
      max-width: 95vw;
    }
    .dice-row {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: nowrap;
    }
    .dice-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .dice-label {
      margin-top: 4px;
      font-size: 0.9em;
      font-weight: bold;
      color: #333;
    }
    .dice {
      width: var(--dice-size, 80px);
      height: var(--dice-size, 80px);
      transform-style: preserve-3d;
      transform: rotateX(0deg) rotateY(0deg);
      transition: transform 1s ease-out;
      cursor: pointer;
      position: relative;
    }
    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      background: white;
      border: 2px solid #333;
      border-radius: 12px;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .face img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .front  { transform: rotateY(0deg) translateZ(calc(var(--dice-size, 80px) / 2)); }
    .back   { transform: rotateY(180deg) translateZ(calc(var(--dice-size, 80px) / 2)); }
    .right  { transform: rotateY(90deg) translateZ(calc(var(--dice-size, 80px) / 2)); }
    .left   { transform: rotateY(-90deg) translateZ(calc(var(--dice-size, 80px) / 2)); }
    .top    { transform: rotateX(90deg) translateZ(calc(var(--dice-size, 80px) / 2)); }
    .bottom { transform: rotateX(-90deg) translateZ(calc(var(--dice-size, 80px) / 2)); }

    #result {
      margin: 10px auto;
      font-size: 1em;
      padding: 6px;
      max-width: 95%;
      text-align: center;
    }
    #footer-hint {
      margin: 12px 0;
      font-size: 1.1em;
      font-weight: bold;
      color: #444;
    }
  </style>
</head>
<body>
  <h1>å’±ä¾†æ’šéª°ä»” ğŸ²</h1>
  <div id="controls">
    <label for="diceCount">éª°ä»”ç²’æ•¸ï¼š</label>
    <select id="diceCount">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
    </select>
    <button onclick="rollDice()">æ’šéª°ä»”</button>
    <button onclick="rollDice()">é–£æ’šä¸€æ“º</button>
    <button onclick="location.href='index.html'">è½‰å»éŠæˆ²é ­é </button>
  </div>

  <div id="instructionBox">
    <strong>æ“ä½œèªªæ˜</strong><br>
    1. é¸æ•¸é‡ â†’ æ’šéª°ä»”
  </div>

  <div id="dice-container"></div>
  <div id="result"></div>

  <div id="footer-hint">éª°ä»”è‹¥åœï¼Œè«‹è¬›å‡ºéƒµç¥¨éª°ä»”çš„å°èªåœ°åã€‚</div>

  <audio id="roll-sound" src="game8_assets/Roll the dice.mp3"></audio>
  <audio id="ding-sound" src="game8_assets/ding1.mp3"></audio>

  <script>
    const diceContainer = document.getElementById("dice-container");
    const resultDiv = document.getElementById("result");
    const rollSound = document.getElementById("roll-sound");
    const dingSound = document.getElementById("ding-sound");

    const stampImages = [
      "game8_assets/stamp1.jpg",
      "game8_assets/stamp2.jpg",
      "game8_assets/stamp3.jpg",
      "game8_assets/stamp4.jpg",
      "game8_assets/stamp5.jpg",
      "game8_assets/stamp6.jpg"
    ];

    function createDie(id, size) {
      const wrapper = document.createElement("div");
      wrapper.className = "dice-wrapper";

      const die = document.createElement("div");
      die.className = "dice";
      die.style.setProperty("--dice-size", size + "px");

      const faces = ["front","back","right","left","top","bottom"];
      for (let i=0;i<6;i++){
        const face=document.createElement("div");
        face.className="face "+faces[i];
        const img=document.createElement("img");
        img.src=stampImages[i % stampImages.length];
        face.appendChild(img);
        die.appendChild(face);
      }

      const label=document.createElement("div");
      label.className="dice-label";
      label.innerText="ç©å®¶ "+id;

      wrapper.appendChild(die);
      wrapper.appendChild(label);

      die.addEventListener("click", rollDice);
      return wrapper;
    }

    function arrangeDice(count){
      diceContainer.innerHTML="";
      const baseSize=100, minSize=50;
      const size=Math.max(minSize, baseSize - count*6);

      let rows=[];
      if(count===1) rows=[1];
      else if(count===2) rows=[1,1];
      else if(count===3) rows=[1,2];
      else if(count===4) rows=[2,2];
      else if(count===5) rows=[2,3];
      else if(count===6) rows=[3,3];
      else if(count===7) rows=[3,4];

      let player=1;
      rows.forEach(r=>{
        const row=document.createElement("div");
        row.className="dice-row";
        for(let i=0;i<r;i++){
          row.appendChild(createDie(player++,size));
        }
        diceContainer.appendChild(row);
      });
    }

    function rollDice(){
      const count=parseInt(document.getElementById("diceCount").value);
      arrangeDice(count);
      resultDiv.innerHTML="";
      rollSound.currentTime=0; rollSound.play();

      const dice=document.querySelectorAll(".dice");
      dice.forEach((die,idx)=>{
        let xRand=720+Math.floor(Math.random()*360);
        let yRand=720+Math.floor(Math.random()*360);
        die.style.transition="transform 1.5s cubic-bezier(.25,1,.3,1)";
        die.style.transform=`rotateX(${xRand}deg) rotateY(${yRand}deg)`;
      });

      setTimeout(()=>{
        dingSound.play();
        let resHTML="<strong>çµæœï¼š</strong><br>";
        dice.forEach((die,i)=>{
          const face=Math.ceil(Math.random()*6);
          let rotation;
          switch(face){
            case 1: rotation="rotateX(0deg) rotateY(0deg)"; break;
            case 2: rotation="rotateY(180deg)"; break;
            case 3: rotation="rotateY(-90deg)"; break;
            case 4: rotation="rotateY(90deg)"; break;
            case 5: rotation="rotateX(-90deg)"; break;
            case 6: rotation="rotateX(90deg)"; break;
          }
          die.style.transform=rotation;

          resHTML+=`ç©å®¶ ${i+1} â†’ <img src="${stampImages[face-1]}" width="40"> éƒµç¥¨<br>`;
        });
        resultDiv.innerHTML=resHTML;
      },1600);
    }

    arrangeDice(1);
  </script>
</body>
</html>
