<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>台語句子配對遊戲</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f0e6ff;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #5c4080;
    }
    #question {
      margin: 20px 0;
      font-size: 1.2em;
      color: #333;
    }
    #choices, #dropzone {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 10px 0;
      min-height: 60px;
      border: 2px dashed #ccc;
      padding: 10px;
      background-color: #fff;
    }
    .word {
      background-color: #d2b4f4;
      margin: 5px;
      padding: 10px 15px;
      border-radius: 10px;
      cursor: grab;
      user-select: none;
      transition: transform 0.2s, background-color 0.2s;
    }
    .word:active {
      transform: scale(1.1);
    }
    .highlight {
      animation: flash 0.3s ease-in-out;
    }
    @keyframes flash {
      0% { background-color: #fff; }
      50% { background-color: #ffff99; }
      100% { background-color: #d2b4f4; }
    }
    .correct {
      animation: correctFlash 0.5s ease-in-out;
    }
    @keyframes correctFlash {
      0% { background-color: #d2b4f4; }
      50% { background-color: #aaffaa; }
      100% { background-color: #d2b4f4; }
    }
    .wrong {
      animation: wrongFlash 0.5s ease-in-out;
    }
    @keyframes wrongFlash {
      0% { background-color: #d2b4f4; }
      50% { background-color: #ff8888; }
      100% { background-color: #d2b4f4; }
    }
    #controls {
      margin: 20px 0;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 1em;
      background-color: #9e7bb5;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #7a5d9a;
    }
    #message {
      font-size: 1.2em;
      color: #b22222;
      margin-top: 10px;
    }
    #cat {
      width: 100px;
      display: none;
      margin: 10px auto;
      animation: slide 1s ease-in-out;
    }
    @keyframes slide {
      0% { transform: translateX(-100%); opacity: 0; }
      50% { transform: translateX(50%); opacity: 1; }
      100% { transform: translateX(0); opacity: 1; }
    }
  </style>
</head>
<body>
  <h1>台語句子配對遊戲</h1>
  <div id="question">請將正確字詞依序拖曳至下方</div>
  <div id="choices"></div>
  <div id="dropzone"></div>
  <div id="controls">
    <button onclick="checkAnswer()">確認答案</button>
    <button onclick="nextQuestion()">下一題</button>
    <button onclick="shuffleAndRestart()">重新開始</button>
    <button onclick="goHome()">回到遊戲首頁</button>
  </div>
  <div id="message"></div>
  <img id="cat" src="https://media.giphy.com/media/v6aOjy0Qo1fIA/giphy.gif" alt="貓咪動畫">
  <audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-4.mp3"></audio>
  <audio id="wrongSound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>

  <script>
    const questions = [
      ["下課", "干焦", "十", "分", "鐘"],
      ["華語", "的", "『蒟蒻』", "台語", "講做", "粉鳥舅"],
      ["人", "講", "中指", "毋通", "烏白", "比"],
      ["伊", "毋是", "彼款", "會", "食錢", "的", "人"],
      ["今仔日", "的", "日頭", "真", "猛"],
      ["這陣", "當咧", "出", "大日虎", "咱", "上好", "莫", "出門", "較袂", "著痧"],
      ["大水雨", "閣", "拄著", "滇流"],
      ["你", "敢", "有", "需要", "人", "共", "你", "鬥相共"]
    ];

    let currentIndex = 0;
    let mistakeCount = 0;
    let shuffledIndices = [];

    function shuffleArray(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function showQuestion() {
      const container = document.getElementById("choices");
      const dropzone = document.getElementById("dropzone");
      const message = document.getElementById("message");
      const cat = document.getElementById("cat");

      container.innerHTML = "";
      dropzone.innerHTML = "";
      message.textContent = "";
      cat.style.display = "none";

      const question = questions[shuffledIndices[currentIndex]];
      const shuffledWords = shuffleArray([...question]);

      shuffledWords.forEach(word => {
        const div = document.createElement("div");
        div.className = "word";
        div.textContent = word;
        div.draggable = true;
        div.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", word);
          div.classList.add("highlight");
        });
        container.appendChild(div);
      });

      dropzone.addEventListener("dragover", e => e.preventDefault());
      dropzone.addEventListener("drop", e => {
        e.preventDefault();
        const data = e.dataTransfer.getData("text/plain");
        const dragged = Array.from(container.children).find(el => el.textContent === data);
        if (dragged) {
          dragged.classList.remove("highlight");
          dropzone.appendChild(dragged);
        }
      });
    }

    function checkAnswer() {
      const dropzone = document.getElementById("dropzone");
      const droppedWords = Array.from(dropzone.children).map(div => div.textContent);
      const correct = questions[shuffledIndices[currentIndex]];

      if (droppedWords.join() === correct.join()) {
        dropzone.childNodes.forEach(el => el.classList.add("correct"));
        document.getElementById("correctSound").play();
        document.getElementById("cat").style.display = "block";
        document.getElementById("message").textContent = "答對了！好棒喔！";
        mistakeCount = 0;
      } else {
        dropzone.childNodes.forEach(el => el.classList.add("wrong"));
        document.getElementById("wrongSound").play();
        mistakeCount++;
        document.getElementById("message").textContent = "毋著喔，閣試一擺";

        if (mistakeCount >= 2) {
          document.getElementById("message").textContent += "\n提示答案：" + correct.join(" ");
        }

        // 重排字詞
        setTimeout(() => {
          showQuestion();
        }, 1000);
      }
    }

    function nextQuestion() {
      currentIndex = (currentIndex + 1) % questions.length;
      mistakeCount = 0;
      showQuestion();
    }

    function shuffleAndRestart() {
      shuffledIndices = Array.from(Array(questions.length).keys());
      shuffledIndices = shuffleArray(shuffledIndices);
      currentIndex = 0;
      mistakeCount = 0;
      showQuestion();
    }

    function goHome() {
      window.location.href = "index.html";
    }

    // 初始
    shuffleAndRestart();
  </script>
</body>
</html>
