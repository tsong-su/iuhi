<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>字詞重組遊戲</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f3e8ff;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #6b21a8;
    }
    .container {
      max-width: 800px;
      margin: auto;
    }
    .word-bank, .answer-zone {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px 0;
      padding: 10px;
      border: 2px dashed #999;
      min-height: 80px;
      background-color: white;
    }
    .word {
      padding: 8px 12px;
      margin: 5px;
      background-color: #ddd6fe;
      border: 1px solid #6b21a8;
      border-radius: 5px;
      cursor: grab;
      transition: background-color 0.3s;
    }
    .word.dragging {
      opacity: 0.5;
      background-color: #facc15;
    }
    .flash-correct {
      animation: flash-green 0.6s;
    }
    .flash-wrong {
      animation: flash-red 0.6s;
    }
    @keyframes flash-green {
      0% { background-color: #4ade80; }
      100% { background-color: white; }
    }
    @keyframes flash-red {
      0% { background-color: #f87171; }
      100% { background-color: white; }
    }
    button {
      margin: 10px;
      padding: 8px 16px;
      background-color: #c084fc;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #a855f7;
    }
    .cat {
      width: 80px;
      position: absolute;
      top: 20px;
      animation: moveCat 1s ease-out forwards;
    }
    @keyframes moveCat {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100vw); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>字詞重組遊戲</h1>
    <div class="word-bank" id="wordBank"></div>
    <div class="answer-zone" id="answerZone"></div>
    <div>
      <button onclick="checkAnswer()">確認</button>
      <button onclick="nextQuestion()">下一條</button>
      <button onclick="resetGame()">重新開始</button>
    </div>
  </div>

  <audio id="correctSound" src="https://cdn.pixabay.com/audio/2021/08/04/audio_e7886ad63b.mp3"></audio>
  <audio id="wrongSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_6f597e7724.mp3"></audio>

  <script>
    const questions = [
      ["下課", "干焦", "十", "分", "鐘"],
      ["華語", "的", "『蒟蒻』", "台語", "講做", "粉鳥舅"],
      ["人", "講", "中指", "毋通", "烏白", "比"],
      ["伊", "毋是", "彼款", "會", "食錢", "的", "人"],
      ["今仔日", "的", "日頭", "真", "猛"],
      ["這陣", "當咧", "出", "大日虎", "咱", "上好", "莫", "出門", "較袂", "著痧"],
      ["大水雨", "閣", "拄著", "滇流"],
      ["你", "敢", "有", "需要", "人", "共", "你", "鬥相共"]
    ];

    let currentIndex = 0;
    let wrongCount = 0;

    function shuffle(arr) {
      return [...arr].sort(() => Math.random() - 0.5);
    }

    function loadQuestion() {
      wrongCount = 0;
      const wordBank = document.getElementById("wordBank");
      const answerZone = document.getElementById("answerZone");
      wordBank.innerHTML = "";
      answerZone.innerHTML = "";
      const words = shuffle(questions[currentIndex]);
      for (let word of words) {
        const div = document.createElement("div");
        div.className = "word";
        div.draggable = true;
        div.textContent = word;
        div.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", word);
          div.classList.add("dragging");
        });
        div.addEventListener("dragend", () => div.classList.remove("dragging"));
        wordBank.appendChild(div);
      }
    }

    const answerZone = document.getElementById("answerZone");
    answerZone.addEventListener("dragover", e => e.preventDefault());
    answerZone.addEventListener("drop", e => {
      e.preventDefault();
      const word = e.dataTransfer.getData("text/plain");
      const div = document.createElement("div");
      div.className = "word";
      div.textContent = word;
      div.draggable = true;
      div.addEventListener("click", () => div.remove());
      answerZone.appendChild(div);
    });

    function checkAnswer() {
      const userWords = Array.from(answerZone.children).map(d => d.textContent);
      const correctWords = questions[currentIndex];
      const correct = userWords.length === correctWords.length && userWords.every((w, i) => w === correctWords[i]);
      if (correct) {
        answerZone.classList.add("flash-correct");
        document.getElementById("correctSound").play();
        showCat();
      } else {
        wrongCount++;
        answerZone.classList.add("flash-wrong");
        document.getElementById("wrongSound").play();
        if (wrongCount >= 2) {
          if (confirm("要看正確答案嗎？")) {
            answerZone.innerHTML = "";
            for (let word of questions[currentIndex]) {
              const div = document.createElement("div");
              div.className = "word";
              div.textContent = word;
              answerZone.appendChild(div);
            }
          }
        }
      }
      setTimeout(() => {
        answerZone.classList.remove("flash-correct");
        answerZone.classList.remove("flash-wrong");
      }, 600);
    }

    function nextQuestion() {
      currentIndex = (currentIndex + 1) % questions.length;
      loadQuestion();
    }

    function resetGame() {
      currentIndex = 0;
      loadQuestion();
    }

    function showCat() {
      const cat = document.createElement("img");
      cat.src = "https://cdn-icons-png.flaticon.com/512/2206/2206368.png";
      cat.className = "cat";
      document.body.appendChild(cat);
      setTimeout(() => cat.remove(), 1000);
    }

    loadQuestion();
  </script>
</body>
</html>
