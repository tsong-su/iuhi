<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>字詞重組遊戲</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f3e8ff; text-align: center; padding: 20px; overflow-x: hidden; }
    h1 { color: #5c3d99; }
    #question-area, #answer-area {
      display: flex; flex-wrap: wrap; justify-content: center;
      margin: 20px auto; min-height: 60px; padding: 10px;
      border: 2px dashed #ccc; background: #fff; border-radius: 10px;
    }
    .word {
      background: #d1c4e9; margin: 5px; padding: 10px 15px;
      border-radius: 10px; cursor: grab; user-select: none;
      transition: box-shadow 0.2s ease;
    }
    .word.dragging {
      animation: flicker 0.5s infinite;
      opacity: 0.6;
      box-shadow: 0 0 12px #7b68ee;
    }
    @keyframes flicker {
      0%,100% { opacity: 0.6; box-shadow: 0 0 12px #7b68ee; }
      50% { opacity: 1; box-shadow: 0 0 20px #9370db; }
    }
    #result { font-size: 1.3em; margin: 20px; min-height: 1.4em; white-space: pre-wrap; color: #444; }
    .correct-flash { animation: correctFlash 0.8s ease-in-out 1; }
    @keyframes correctFlash {
      0%,100% { background: #c8e6c9; } 50% { background: #81c784; }
    }
    #controls { margin: 20px; }
    button { margin: 5px; padding: 10px 20px; font-size: 16px;
      border:none; border-radius: 8px; background: #9575cd; color:white; cursor:pointer; }
    button:hover { background: #7e57c2; }
    #wrongCount { margin-top: 10px; color: #d32f2f; font-weight:bold; }
    #cat-left, #cat-right {
      position: fixed; bottom:0; width:80px; height:80px; background-size:contain;
      background-repeat:no-repeat; z-index:999;
      display:none; pointer-events:none;
    }
    #cat-left { background-image:url('https://i.imgur.com/MbJFdIb.png'); left: -100px; }
    #cat-right { background-image:url('https://i.imgur.com/Z8FtrTf.png'); right:-100px; }
    @keyframes catLeftMove {0%{left:-100px;}50%{left:50%;}100%{left:-100px;}}
    @keyframes catRightMove {0%{right:-100px;}50%{right:50%;}100%{right:-100px;}}
  </style>
</head>
<body>
  <h1>字詞重組遊戲</h1>
  <div id="wrongCount">錯誤次數：0</div>
  <div id="question-area"></div>
  <div id="answer-area"></div>
  <div id="result"></div>
  <div id="controls">
    <button onclick="restartGame()">重新開始</button>
  </div>
  <a href="index.html"><button>回到遊戲首頁</button></a>
  <audio id="sound-correct" src="https://cdn.pixabay.com/audio/2022/03/15/audio_65b1c0d12c.mp3"></audio>
  <audio id="sound-wrong" src="https://cdn.pixabay.com/audio/2022/03/15/audio_e893b50e2f.mp3"></audio>
  <div id="cat-left"></div>
  <div id="cat-right"></div>

<script>
const questions = [
  ["下課","干焦","十","分","鐘"],
  ["華語","的","『蒟蒻』","台語","講做","粉鳥舅"],
  ["人","講","中指","毋通","烏白","比"],
  ["伊","毋是","彼款","會","食錢","的","人"],
  ["今仔日","的","日頭","真","猛"],
  ["這陣","當咧","出","大日虎","咱","上好","莫","出門","較袂","著痧"],
  ["大水雨","閣","拄著","滇流"],
  ["你","敢","有","需要","人","共","你","鬥相共"]
];
let idx = 0, wrong = 0;
const qa = document.getElementById("question-area");
const aa = document.getElementById("answer-area");
const res = document.getElementById("result");
const wc = document.getElementById("wrongCount");
const sc = document.getElementById("sound-correct");
const sw = document.getElementById("sound-wrong");
const catL = document.getElementById("cat-left");
const catR = document.getElementById("cat-right");

function shuffle(a){return a.sort(()=>Math.random()-0.5)}

function loadQ(){
  wrong=0; wc.textContent=`錯誤次數：0`;
  res.textContent=""; aa.innerHTML=""; qa.innerHTML=""; hideCats();
  const arr = shuffle([...questions[idx]]);
  arr.forEach(w=>{
    const d=document.createElement("div");
    d.textContent=w; d.className="word"; d.draggable=true;
    d.addEventListener("dragstart",ds); qa.appendChild(d);
  });
  for(let i=0;i<questions[idx].length;i++){
    const box=document.createElement("div");
    box.className="word"; box.style.background="#eee";
    box.style.minWidth="40px"; box.style.minHeight="30px";
    box.addEventListener("dragover",e=>e.preventDefault());
    box.addEventListener("drop",drop);
    aa.appendChild(box);
  }
}

function ds(e){
  e.dataTransfer.setData("text", e.target.textContent);
  e.target.classList.add("dragging");
}
document.addEventListener("dragend", e=>{
  if(e.target.classList) e.target.classList.remove("dragging");
});

function drop(e){
  e.preventDefault();
  const txt=e.dataTransfer.getData("text");
  e.target.textContent=txt;
  check();
}

function check(){
  const user = Array.from(aa.children).map(d=>d.textContent);
  if(user.includes("")) return;
  const corr = questions[idx];
  const ok=user.every((w,i)=>w===corr[i]);
  if(ok){
    sc.play(); aa.childNodes.forEach(d=>{d.classList.add("correct-flash");});
    showCats();
    setTimeout(()=>{idx=(idx+1)%questions.length; loadQ();},1500);
  } else {
    wrong++; wc.textContent=`錯誤次數：${wrong}`; sw.play();
    aa.childNodes.forEach(d=>{d.textContent="";});
    if(wrong>=2){
      res.textContent = '提示正確答案→ ' + corr.join(' ');
    }
  }
}

function restartGame(){
  idx=0; loadQ();
}

function showCats(){
  catL.style.display=catR.style.display="block";
  catL.style.animation="catLeftMove 2s ease forwards";
  catR.style.animation="catRightMove 2s ease forwards";
  setTimeout(hideCats, 2100);
}

function hideCats(){
  catL.style.display=catR.style.display="none";
  catL.style.animation=catR.style.animation="";
}

window.onload=loadQ;
</script>
</body>
</html>
