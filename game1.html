<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8" />
  <title>台語字詞排序遊戲</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    #sentence {
      font-size: 24px;
      margin: 20px;
    }
    #word-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 20px;
    }
    .word {
      padding: 10px 15px;
      margin: 5px;
      border: 1px solid #333;
      border-radius: 5px;
      background-color: #f0f0f0;
      cursor: grab;
    }
    .word.dragging {
      opacity: 0.5;
    }
    #controls {
      margin: 20px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
    }
    #dict-link {
      margin-top: 15px;
      display: block;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <h1>台語字詞排序遊戲</h1>
  <div id="sentence">請依正確順序排列詞語：</div>
  <div id="word-container"></div>
  <div id="controls">
    <button onclick="checkAnswer()">確認答案</button>
    <button onclick="nextQuestion()">後一條</button>
    <button onclick="restartGame()">重新開始</button>
    <button onclick="showAnswer()">提示正確答案</button>
    <button onclick="goHome()">回到遊戲首頁</button>
  </div>
  <audio id="audioPlayer" controls style="margin-top: 20px;"></audio>
  <a id="dict-link" href="#" target="_blank"></a>

  <script>
    const questions = [
      {
        words: ["半老老", "猶閣", "愛", "做", "苦力"],
        answer: "半老老猶閣愛做苦力。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1262.mp3",
        dict: {
          word: "半老老",
          url: "https://sutian.moe.edu.tw/und-hani/su/1262/"
        }
      },
      {
        words: ["逐工", "攏", "去", "做", "散工"],
        answer: "逐工攏去做散工。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1097.mp3",
        dict: {
          word: "散工",
          url: "https://sutian.moe.edu.tw/und-hani/su/1097/"
        }
      },
      {
        words: ["伊", "好額人", "做", "大官虎"],
        answer: "伊好額人做大官虎。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/422.mp3",
        dict: {
          word: "大官虎",
          url: "https://sutian.moe.edu.tw/und-hani/su/422/"
        }
      },
      {
        words: ["伊", "是", "抓耙仔", "，", "凡勢", "攏", "提去", "報告"],
        answer: "伊是抓耙仔，凡勢攏提去報告。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/3180.mp3",
        dict: {
          word: "抓耙仔",
          url: "https://sutian.moe.edu.tw/und-hani/su/3180/"
        }
      },
      {
        words: ["逐工", "攏", "咧", "摸飛", "，", "都", "無", "認真", "讀冊"],
        answer: "逐工攏咧摸飛，都無認真讀冊。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/3032.mp3",
        dict: {
          word: "摸飛",
          url: "https://sutian.moe.edu.tw/und-hani/su/3032/"
        }
      },
      {
        words: ["阿母", "咧", "挲圓仔湯"],
        answer: "阿母咧挲圓仔湯。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/3734.mp3",
        dict: {
          word: "挲圓仔湯",
          url: "https://sutian.moe.edu.tw/und-hani/su/3734/"
        }
      },
      {
        words: ["這个", "所在", "伊", "做", "摠頭"],
        answer: "这个所在伊做摠頭。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/3280.mp3",
        dict: {
          word: "摠頭",
          url: "https://sutian.moe.edu.tw/und-hani/su/3280/"
        }
      },
      {
        words: ["查埔囝", "做", "二步七仔", "，", "一工", "無閒", "做"],
        answer: "查埔囝做二步七仔，一工無閒做。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1860.mp3",
        dict: {
          word: "二步七仔",
          url: "https://sutian.moe.edu.tw/und-hani/su/1860/"
        }
      },
      {
        words: ["伊", "真", "健丟", "，", "人講", "的話", "攏", "聽袂入去"],
        answer: "伊真健丟，人講的話攏聽袂入去。",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/2227.mp3",
        dict: {
          word: "健丟",
          url: "https://sutian.moe.edu.tw/und-hani/su/2227/"
        }
      },
      {
        words: ["流行性", "感冒", "病毒", "的", "暗作期", "大約", "是", "一工", "到", "三工"],
        answer: "流行性感冒病毒的暗作期大約是一工到三工",
        audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/8U/SA/29455-1-1.mp3",
        dict: {
          word: "暗作期",
          url: "https://sutian.moe.edu.tw/und-hani/su/29455/"
        }
      }
    ];

    let currentQuestion = 0;

    function loadQuestion() {
      const question = questions[currentQuestion];
      const container = document.getElementById("word-container");
      container.innerHTML = "";

      let words = [...question.words];
      words = words.sort(() => Math.random() - 0.5);

      words.forEach(word => {
        const div = document.createElement("div");
        div.className = "word";
        div.textContent = word;
        div.draggable = true;

        div.addEventListener("dragstart", () => {
          div.classList.add("dragging");
        });
        div.addEventListener("dragend", () => {
          div.classList.remove("dragging");
        });

        container.appendChild(div);
      });

      const audioPlayer = document.getElementById("audioPlayer");
      audioPlayer.src = question.audio;
      audioPlayer.play();

      const dictLink = document.getElementById("dict-link");
      dictLink.textContent = `查詢詞語：「${question.dict.word}」`;
      dictLink.href = question.dict.url;
    }

    document.getElementById("word-container").addEventListener("dragover", e => {
      e.preventDefault();
      const afterElement = getDragAfterElement(e.clientX, e.clientY);
      const dragging = document.querySelector(".dragging");
      if (afterElement == null) {
        document.getElementById("word-container").appendChild(dragging);
      } else {
        document.getElementById("word-container").insertBefore(dragging, afterElement);
      }
    });

    function getDragAfterElement(x, y) {
      const elements = [...document.querySelectorAll(".word:not(.dragging)")];
      return elements.find(element => {
        const rect = element.getBoundingClientRect();
        return y < rect.top + rect.height / 2;
      });
    }

    function checkAnswer() {
      const arranged = [...document.querySelectorAll(".word")].map(div => div.textContent).join("");
      if (arranged === questions[currentQuestion].answer.replace(/[，。]/g, "")) {
        alert("正確！");
      } else {
        alert("答案不正確，再試一次。");
      }
    }

    function nextQuestion() {
      currentQuestion = (currentQuestion + 1) % questions.length;
      loadQuestion();
    }

    function restartGame() {
      currentQuestion = 0;
      loadQuestion();
    }

    function showAnswer() {
      alert("正確答案是：" + questions[currentQuestion].answer);
    }

    function goHome() {
      window.location.href = "index.html";
    }

    window.onload = loadQuestion;
  </script>
</body>
</html>
