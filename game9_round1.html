<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æœå­åœ–ç‰‡&å°èªæœå­åé…å° - ç¬¬1å›</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0; padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #fff9f0;
    }
    h1 {
      margin: 10px;
      color: #d2691e;
    }
    .game-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 30px;
      flex-wrap: wrap;
      width: 100%;
      max-width: 950px;
    }
    .images, .names {
      display: grid;
      gap: 10px;
    }
    .images {
      grid-template-columns: repeat(2, 120px);
    }
    .images img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border: 3px solid transparent;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    .images img.selected {
      border: 3px solid #ff6600;
      transform: scale(1.1);
    }
    .images img.matched {
      opacity: 0.5;
      pointer-events: none;
    }
    .names {
      grid-template-columns: repeat(1, 180px);
    }
    .name-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .names button {
      flex: 1;
      margin-right: 5px;
      padding: 8px;
      background: #ffe4b5;
      border: 2px solid #d2691e;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      font-size: 16px;
    }
    .names button:hover {
      background: #ffdead;
    }
    .names button.matched {
      background: #ccc;
      pointer-events: none;
    }
    .dict-link {
      font-size: 14px;
      text-decoration: none;
      background: #f08080;
      color: white;
      padding: 6px;
      border-radius: 6px;
    }
    #victory {
      font-size: 48px;
      color: green;
      margin-top: 20px;
      display: none;
      animation: grow 2s forwards;
    }
    @keyframes grow {
      from { transform: scale(0.2); opacity: 0; }
      to   { transform: scale(1.5); opacity: 1; }
    }
    #nextRound {
      display: none;
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 18px;
      background: #ffa500;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>æœå­åœ–ç‰‡&å°èªæœå­åé…å° - ç¬¬1å›</h1>
  <div class="game-container">
    <div class="images" id="images"></div>
    <div class="names" id="names"></div>
  </div>
  <div id="victory">æœ‰å¤  gÃ¢uï¼</div>
  <button id="nextRound" onclick="alert('é€™è£¡åˆ‡æ›åˆ°ç¬¬2å›ç¨‹å¼ï¼Œç¨å¾Œå¯æ“´å……')">ä¸‹ä¸€å›åˆ â–¶</button>

  <audio id="wrong-sound" src="game9_assets/wrong1.mp3"></audio>
  <audio id="victory-sound" src="game9_assets/victory2.mp3"></audio>

  <script>
    const imageContainer = document.getElementById("images");
    const nameContainer = document.getElementById("names");
    const wrongSound = document.getElementById("wrong-sound");
    const victorySound = document.getElementById("victory-sound");
    const victoryText = document.getElementById("victory");
    const nextRoundBtn = document.getElementById("nextRound");

    let selectedImage = null;
    let matchedCount = 0;
    let fruits = [];

    // æ‰“äº‚é™£åˆ—
    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    // è¼‰å…¥ JSON å‰8ç­†
    fetch("game9_assets/fruits_part1.json")
      .then(res => res.json())
      .then(data => {
        fruits = data.slice(0, 8); // ç¬¬1å› 8ç­†
        initGame(fruits);
      });

    function initGame(fruits) {
      // æ¸…ç©º
      imageContainer.innerHTML = "";
      nameContainer.innerHTML = "";
      matchedCount = 0;
      selectedImage = null;

      // å»ºç«‹åœ–ç‰‡
      fruits.forEach(fruit => {
        const img = document.createElement("img");
        img.src = `game9_assets/${fruit.id}.png`;
        img.dataset.id = fruit.id;
        img.addEventListener("click", () => selectImage(img));
        imageContainer.appendChild(img);
      });

      // å»ºç«‹åç¨±æŒ‰éˆ• (æ‰“äº‚)
      shuffle([...fruits]).forEach(fruit => {
        const div = document.createElement("div");
        div.className = "name-item";

        const btn = document.createElement("button");
        btn.textContent = fruit.taiwanese;
        btn.dataset.id = fruit.id;
        btn.addEventListener("click", () => selectName(btn, fruit.audio));

        const link = document.createElement("a");
        link.href = fruit.link;
        link.target = "_blank";
        link.className = "dict-link";
        link.textContent = "ğŸ”—";

        div.appendChild(btn);
        div.appendChild(link);
        nameContainer.appendChild(div);
      });
    }

    function selectImage(img) {
      if (img.classList.contains("matched")) return;
      document.querySelectorAll(".images img").forEach(i => i.classList.remove("selected"));
      img.classList.add("selected");
      selectedImage = img;
    }

    function selectName(btn, audioUrl) {
      if (!selectedImage) return;
      const imgId = selectedImage.dataset.id;
      const nameId = btn.dataset.id;

      if (imgId === nameId) {
        // æ­£ç¢º
        selectedImage.classList.add("matched");
        btn.classList.add("matched");
        selectedImage.classList.remove("selected");

        new Audio(audioUrl).play();

        matchedCount++;
        if (matchedCount === fruits.length) {
          victorySound.play();
          victoryText.style.display = "block";
          nextRoundBtn.style.display = "inline-block";
        }
      } else {
        wrongSound.play();
        selectedImage.classList.remove("selected");
      }
      selectedImage = null;
    }
  </script>
</body>
</html>

