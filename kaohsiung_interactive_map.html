<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é«˜é›„å¸‚38å€æ–°èˆŠåœ°åäº’å‹•åœ°åœ– v6.11</title>
<style>
  html,body{margin:0;height:100%;font-family:"Noto Sans TC",system-ui,"Microsoft JhengHei",sans-serif;background:#f8f9fb;color:#0f172a;text-align:center}
  h1{margin:8px 0 4px;font-size:1.5rem;font-weight:800}
  .notice{margin:2px 0;color:#555;font-size:.95rem}

  /* ä¸Šæ–¹ç¾¤çµ„æŒ‰éˆ• */
  .groupbar{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;max-width:980px;margin:10px auto;padding:0 12px}
  .groupbar button{
    border:0;border-radius:14px;padding:10px 6px;font-size:1rem;color:#fff;cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,.18);transition:all .2s;position:relative;line-height:1.1
  }
  @media (max-width:420px){.groupbar button{font-size:.95rem}}
  .groupbar button.is-on{outline:2px solid #fff;transform:translateY(-1px)}
  .btn-core{background:linear-gradient(145deg,#6FA8DC,#9EC6F2)}
  .btn-east{background:linear-gradient(145deg,#93C47D,#B5D99F)}
  .btn-north{background:linear-gradient(145deg,#F6B26B,#FFD79C)}
  .btn-mount{background:linear-gradient(145deg,#B4A7D6,#D2C4F2)}
  .badge{position:absolute;top:-6px;right:-8px;border-radius:50%;background:#fff;color:#333;
         min-width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:700}

  #mapbox{width:100%;max-width:980px;margin:auto;height:calc(100vh - 230px);min-height:420px;
          background:#fff;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.08);overflow:hidden;border:1px solid #e5e7eb}
  object{width:100%;height:100%}

  /* æ·¡åŒ–èˆ‡é–ƒå…‰ */
  .dimmed{opacity:.15;transition:opacity .3s ease}
  .strong-stroke{stroke:#1f2937;stroke-width:.9}
  .light-stroke{stroke:#aaa;stroke-width:.6}

  @keyframes groupFlash{
    0%,100%{filter:brightness(1)}
    50%{filter:brightness(1.6)}
  }
  .flash-group{animation:groupFlash 1.2s ease}

  @keyframes glow {
    0%{filter:drop-shadow(0 0 0 rgba(255,255,255,0))}
    50%{filter:drop-shadow(0 0 10px rgba(255,255,255,1))}
    100%{filter:drop-shadow(0 0 0 rgba(255,255,255,0))}
  }
  .glow{animation:glow 1.2s ease;stroke:#000;stroke-width:2.5!important}

  /* æµ®æ¡† */
  .popup{position:absolute;display:none;background:#fff;border-radius:12px;padding:10px;
         border:1px solid rgba(0,0,0,.08);box-shadow:0 10px 24px rgba(0,0,0,.18);z-index:60}
  .popup h3{margin:0 0 4px;font-size:1.05rem;font-weight:700}
  .newP{color:#00796b;font-weight:700}
  .oldP{color:#6a1b9a;font-weight:700}
  .row{display:flex;gap:8px;margin-top:8px;justify-content:center;flex-wrap:wrap}
  .btn{padding:6px 10px;border-radius:10px;border:0;color:#fff;cursor:pointer;box-shadow:0 3px 8px rgba(0,0,0,.22)}
  .btn.play{background:linear-gradient(145deg,#64b5f6,#1565c0)}
  .btn.old{background:linear-gradient(145deg,#ffa27a,#e66a3a)}

  footer{padding:12px 0}
  footer a{display:inline-block;background:linear-gradient(145deg,#4CAF50,#2e7d32);color:#fff;
           padding:8px 16px;border-radius:12px;text-decoration:none;box-shadow:0 3px 8px rgba(0,0,0,.22)}
</style>
</head>
<body>
  <h1>é«˜é›„å¸‚38å€æ–°èˆŠåœ°åäº’å‹•åœ°åœ–</h1>
  <p class="notice">ğŸ“± å»ºè­°ç›´å¼è§€çœ‹æ•ˆæœæœ€ä½³</p>
  <p class="notice">ğŸ‘† é»è¡Œæ”¿å€çœ‹æ–°èˆŠåœ°åä¸¦æ’­æ”¾éŸ³æª”</p>

  <div class="groupbar" id="groupbar">
    <button class="btn-core is-on"  data-group="core">å¸‚ä¸­å¿ƒ<span class="badge">11</span></button>
    <button class="btn-east"         data-group="east">å¸‚éƒŠ-æ±å€<span class="badge">7</span></button>
    <button class="btn-north"        data-group="north">å¸‚éƒŠ-åŒ—å€<span class="badge">11</span></button>
    <button class="btn-mount"        data-group="mountain">å±±å€<span class="badge">9</span></button>
  </div>

  <main>
    <div id="mapbox">
      <object id="svgMap" data="map_assets/Blank_Kaohsiung_map.svg" type="image/svg+xml"></object>
      <div class="popup" id="popup">
        <h3 id="pop-new">â€”</h3>
        <div class="newP" id="pop-new-poj">â€”</div>
        <div id="pop-old">â€”</div>
        <div class="oldP" id="pop-old-poj">â€”</div>
        <div class="row">
          <button class="btn play" id="btn-new">æ’­æ”¾æ–°åœ°å</button>
          <button class="btn old" id="btn-old">æ’­æ”¾èˆŠåœ°å</button>
        </div>
      </div>
    </div>
  </main>
  <footer><a href="https://tsong-su.github.io/iuhi/index.html">ğŸ  å›éŠæˆ²é¦–é </a></footer>

<script>
/* ======= è¨­å®š ======= */
const COLORS={
  core:"#6FA8DC",east:"#93C47D",north:"#F6B26B",mountain:"#B4A7D6"
};
const GROUPS={
  core:["æ¥ æ¢“","å·¦ç‡Ÿ","é¼“å±±","ä¸‰æ°‘","é¹½åŸ•","å‰é‡‘","æ–°èˆˆ","è‹“é›…","æ——æ´¥","å‰é®","å°æ¸¯"],
  east:["å¤§æ¨¹","å¤§å¯®","æ—åœ’","å¤§ç¤¾","ä»æ­¦","é³¥æ¾","é³³å±±"],
  north:["èŒ„è£","æ°¸å®‰","å½Œé™€","æ¢“å®˜","æ¹–å…§","è·¯ç«¹","å²¡å±±","æ©‹é ­","é˜¿è“®","ç”°å¯®","ç‡•å·¢"],
  mountain:["å…§é–€","æ——å±±","æ‰æ—","ç¾æ¿ƒ","ç”²ä»™","å…­é¾œ","é‚£ç‘ªå¤","æ¡ƒæº","èŒ‚æ—"]
};
const DATA={
  "ç”°å¯®":{old:"ç”°è—”",newPoj:"TshÃ¢n-liÃ¢u",oldPoj:"TshÃ¢n-liÃ¢u"},
  "æ——å±±":{old:"è•ƒè–¯è—”",newPoj:"KÃ®-san",oldPoj:"Han-tsÃ®-liÃ¢u"},
  "ç¾æ¿ƒ":{old:"ç€°æ¿ƒ",newPoj:"Bi-long",oldPoj:"BÃ®-long"},
  // å…¶é¤˜è³‡æ–™åŒå‰ï¼Œçœç•¥â€¦
};

let svgDoc=null,items=[],currentGroup="core";
const popup=$("#popup"),audioNew=new Audio(),audioOld=new Audio();
const $=(s,e=document)=>e.querySelector(s),$$=(s,e=document)=>Array.from(e.querySelectorAll(s));
function stripQu(s){return (s||"").replace(/å€$/,'');}
function onlyHan(t){const m=(t||'').match(/[\u4E00-\u9FFF]+/g);return m?m.join(''):'';}
function getName(el){const t=el.querySelector("title");return t?onlyHan(t.textContent):onlyHan(el.id);}

/* ======= è¼‰å…¥ SVG ======= */
$("#svgMap").addEventListener("load",()=>{
  svgDoc=$("#svgMap").contentDocument;
  const shapes=svgDoc.querySelectorAll("path,polygon,polyline");
  shapes.forEach(el=>{
    const n=stripQu(getName(el));if(!n) return;
    const g=Object.entries(GROUPS).find(([k,v])=>v.includes(n))?.[0];if(!g) return;
    el.style.fill=COLORS[g];el.classList.add("strong-stroke");el.style.cursor="pointer";
    el.addEventListener("click",e=>highlightDistrict(e,el,n,g));
    items.push({el,name:n,group:g});
  });
  updateGroup();
});

/* ======= ç¾¤çµ„åˆ‡æ› ======= */
function updateGroup(){
  items.forEach(d=>{
    const isCur=d.group===currentGroup;
    d.el.classList.toggle("dimmed",!isCur);
    d.el.classList.toggle("light-stroke",!isCur);
    d.el.classList.toggle("strong-stroke",isCur);
  });
}
function flashGroup(g){
  items.filter(d=>d.group===g).forEach(d=>{
    d.el.classList.add("flash-group");
    setTimeout(()=>d.el.classList.remove("flash-group"),1200);
  });
}
$$(".groupbar button").forEach(btn=>{
  btn.onclick=()=>{
    currentGroup=btn.dataset.group;
    updateGroup();flashGroup(currentGroup);
    popup.style.display="none";
  };
});

/* ======= é»é¸å–®ä¸€è¡Œæ”¿å€ ======= */
function highlightDistrict(evt,el,n,g){
  el.classList.add("glow");
  setTimeout(()=>el.classList.remove("glow"),1200);

  $("#pop-new").textContent=n;
  $("#pop-new-poj").textContent=(DATA[n]||{}).newPoj||"";
  $("#pop-old").textContent=(DATA[n]||{}).old||"";
  $("#pop-old-poj").textContent=(DATA[n]||{}).oldPoj||"";

  const box=$("#mapbox").getBoundingClientRect();
  popup.style.display="block";
  let left=evt.clientX-box.left+10,top=evt.clientY-box.top+10;
  if(left+popup.offsetWidth>box.width)left=box.width-popup.offsetWidth-8;
  if(top+popup.offsetHeight>box.height)top=box.height-popup.offsetHeight-8;
  popup.style.left=left+"px";popup.style.top=top+"px";
}

/* ======= å·¥å…· ======= */
document.addEventListener("click",e=>{
  if(!e.target.closest("#mapbox")||e.target.closest(".groupbar"))popup.style.display="none";
});
</script>
</body>
</html>
