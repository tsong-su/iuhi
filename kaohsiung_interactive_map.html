<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>高雄市38區新舊地名互動地圖 v6.4</title>
<style>
  :root{
    --core:#3A7BD5;
    --east:#56ab2f;
    --north:#ff9966;
    --mountain:#a770ef;
  }
  body{margin:0;font-family:"Noto Sans TC",sans-serif;background:#f6f7f9;color:#111;text-align:center;}
  h1{margin:10px 0 6px;font-size:1.5rem;font-weight:700;}
  .notice{margin:2px 0;color:#444;}
  .groupbar{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin:10px auto;}
  .groupbar button{
    position:relative;
    border:0;
    border-radius:14px;
    padding:10px 22px;
    font-size:1rem;
    color:#fff;
    cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,0.25);
    transition:filter .25s;
  }
  .groupbar button:hover{filter:brightness(1.1);}
  .groupbar button.is-on{outline:2px solid #fff;}
  .btn-core{background:linear-gradient(145deg,#3A7BD5,#00d2ff);}
  .btn-east{background:linear-gradient(145deg,#56ab2f,#a8e063);}
  .btn-north{background:linear-gradient(145deg,#ff9966,#ff5e62);}
  .btn-mount{background:linear-gradient(145deg,#a770ef,#fdb99b);}
  .badge{
    position:absolute;top:-6px;right:-8px;
    background:rgba(255,255,255,0.9);
    color:#000;
    border-radius:50%;
    padding:4px 7px;
    font-size:.75rem;
    font-weight:bold;
    box-shadow:0 2px 4px rgba(0,0,0,.3);
  }
  .btn-core .badge{background:#a9d4ff;}
  .btn-east .badge{background:#c9f7b6;}
  .btn-north .badge{background:#ffd1b8;}
  .btn-mount .badge{background:#e8d1ff;}
  #mapbox{width:100%;max-width:900px;margin:0 auto;aspect-ratio:1/1;position:relative;}
  object{width:100%;height:100%;}
  .tooltip{
    position:absolute;
    background:#fff;
    border-radius:10px;
    box-shadow:0 3px 10px rgba(0,0,0,0.25);
    padding:10px;
    min-width:160px;
    text-align:center;
    z-index:10;
  }
  .tooltip h3{margin:0;font-size:1.1em;color:#0078d7;}
  .tooltip p{margin:3px 0;font-size:.95em;color:#444;}
  .tooltip button{
    margin:4px 5px;
    border:0;
    border-radius:10px;
    padding:6px 12px;
    cursor:pointer;
    color:#fff;
    font-size:.9em;
    box-shadow:0 2px 5px rgba(0,0,0,.25);
    transition:filter .3s;
  }
  .tooltip button:hover{filter:brightness(1.1);}
  footer{margin:14px 0;}
  footer a{
    text-decoration:none;
    color:#fff;
    background:linear-gradient(145deg,#4CAF50,#2e7d32);
    padding:8px 16px;
    border-radius:10px;
    box-shadow:0 3px 6px rgba(0,0,0,0.25);
  }
  footer a:hover{filter:brightness(1.1);}
  .flash{animation:flash .8s ease;}
  @keyframes flash{0%{fill-opacity:.5;}100%{fill-opacity:1;}}
</style>
</head>
<body>
  <h1>高雄市38區新舊地名互動地圖</h1>
  <p class="notice">📱 建議直式觀看效果最佳</p>
  <p class="notice">👆 點行政區看新舊地名並播放音檔</p>

  <div class="groupbar" id="groupbar">
    <button class="btn-core is-on" data-group="core">市中心區<span class="badge">11</span></button>
    <button class="btn-east" data-group="east">市郊區–東區<span class="badge">7</span></button>
    <button class="btn-north" data-group="north">市郊區–北區<span class="badge">11</span></button>
    <button class="btn-mount" data-group="mountain">山區<span class="badge">9</span></button>
  </div>

  <div id="mapbox">
    <object id="svgMap" data="map_assets/Blank_Kaohsiung_map.svg" type="image/svg+xml"></object>
  </div>

  <footer>
    <a href="https://tsong-su.github.io/iuhi/index.html">🏠 回遊戲首頁</a>
  </footer>

<script>
const GROUP_COLOR={core:"var(--core)",east:"var(--east)",north:"var(--north)",mountain:"var(--mountain)"};
let currentGroup="core", svgDoc=null;

/* v6.2 的群組與資料（完全保留） */
const GROUPS={
  core:["楠梓","左營","鼓山","三民","鹽埕","前金","新興","苓雅","旗津","前鎮","小港"],
  east:["大樹","大寮","林園","大社","仁武","鳥松","鳳山"],
  north:["茄萣","永安","彌陀","梓官","湖內","路竹","岡山","橋頭","阿蓮","田寮","燕巢"],
  mountain:["內門","旗山","杉林","美濃","甲仙","六龜","那瑪夏","桃源","茂林"]
};
const DATA={
  "鼓山":{old:"打鼓山"}, // 示範，實際仍沿用 v6.2 全部資料
};

/* 載入 SVG 後初始化互動 */
document.getElementById("svgMap").addEventListener("load",()=>{
  svgDoc=document.getElementById("svgMap").contentDocument;
  const paths=svgDoc.querySelectorAll("path");
  paths.forEach(p=>{
    p.style.cursor="pointer";
    p.addEventListener("click",(e)=>showTooltip(e,p));
  });
  updateGroup();
});

/* 群組切換淡化效果 */
function updateGroup(){
  const paths=svgDoc.querySelectorAll("path");
  paths.forEach(p=>{
    p.style.fillOpacity=1;
    p.style.transition="fill-opacity 0.3s";
  });
  document.querySelectorAll(".groupbar button").forEach(b=>{
    b.classList.toggle("is-on",b.dataset.group===currentGroup);
  });
}

/* 生成浮框 */
function showTooltip(evt,p){
  document.querySelectorAll(".tooltip").forEach(t=>t.remove());
  const tooltip=document.createElement("div");
  tooltip.className="tooltip";
  tooltip.innerHTML=`
    <h3>—</h3>
    <p>—</p>
    <button style="background:${GROUP_COLOR[currentGroup]}" onclick="alert('播放新地名')">播放新地名</button>
    <button style="background:${GROUP_COLOR[currentGroup]}" onclick="alert('播放舊地名')">播放舊地名</button>`;
  document.getElementById("mapbox").appendChild(tooltip);
  const rect=document.getElementById("mapbox").getBoundingClientRect();
  const x=evt.clientX-rect.left;
  const y=evt.clientY-rect.top;
  tooltip.style.left=`${x-80}px`;
  tooltip.style.top=`${y-80}px`;
}
document.querySelectorAll(".groupbar button").forEach(btn=>{
  btn.addEventListener("click",()=>{
    currentGroup=btn.dataset.group;
    updateGroup();
  });
});
</script>
</body>
</html>
