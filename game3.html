<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8" />
<title>華台動物語詞配對</title>
<style>
  body {
    font-family: "Microsoft JhengHei", sans-serif;
    background-color: #f3f1d9; /* 淺草色 */
    color: #6a0d4d;
    margin: 0;
    padding: 20px;
  }
  h1 {
    color: #a83262;
    text-align: center;
    margin-bottom: 5px;
  }
  #subtitle {
    text-align: center;
    font-size: 1.1em;
    font-weight: 600;
    color: #914d6c;
    margin-bottom: 20px;
  }
  /* 分數置中 */
  #score {
    font-size: 1.6em;
    font-weight: bold;
    text-align: center;
    margin-bottom: 20px;
    color: #6a0d4d;
  }
  #button-container {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 25px;
  }
  #btnRestart, #btnPrev, a#back-home {
    background-color: #4caf50; /* 綠色統一 */
    color: white;
    border: none;
    padding: 8px 20px;
    border-radius: 25px;
    font-size: 1em;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 3px 7px rgba(76, 175, 80, 0.7);
    transition: background-color 0.3s;
    text-align: center;
    text-decoration: none;
    user-select: none;
  }
  #btnRestart:hover, #btnPrev:hover, a#back-home:hover {
    background-color: #388e3c;
  }
  .container {
    display: flex;
    justify-content: center;
    gap: 30px;
    flex-wrap: nowrap;
  }
  .column {
    border-radius: 15px;
    box-shadow: 0 5px 10px rgba(168, 50, 98, 0.3);
    min-width: 320px;
    max-width: 350px;
    background: #fff0f6;
    padding: 20px;
    user-select: none;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    height: auto;
  }
  #mandarin {
    background: #ffd6e8;
    border: 2px solid #dda0b9;
    color: #6a0d4d;
  }
  #taiwanese {
    background: #b2e0ff;
    border: 2px solid #8ec4f9;
    color: #1a73e8;
  }
  .column-header {
    font-size: 1.8em;
    font-weight: 900;
    color: inherit;
    user-select: none;
    text-align: center;
    margin-bottom: 10px;
    line-height: 1.2;
  }
  .words-container {
    flex-wrap: wrap;
    flex-grow: 1;
    display: flex;
    gap: 12px;
    justify-content: center;
    align-content: flex-start;
    overflow-x: hidden;
    max-height: none;
  }
  .word {
    background-color: #fff0f6;
    padding: 14px 18px;
    border: 2px solid #dda0b9;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.6em; /* 字體加大 */
    font-weight: 700;
    white-space: nowrap;
    transition: background 0.3s, border-color 0.3s, color 0.3s;
    color: #6a0d4d;
    user-select: none;
  }
  #taiwanese .word {
    background-color: #e3f0ff;
    border-color: #8ec4f9;
    color: #1a73e8;
  }
  .word.selected {
    background-color: #f8bbd0;
    border-color: #e91e63;
    color: #660033;
  }
  #taiwanese .word.selected {
    background-color: #90caf9;
    border-color: #1a73e8;
    color: #0d47a1;
  }
  .word.matched {
    background-color: #f48fb1;
    border-color: #ad1457;
    cursor: default;
    color: white;
    font-weight: 900;
  }
  #taiwanese .word.matched {
    background-color: #2196f3;
    border-color: #1565c0;
    color: white;
    font-weight: 900;
  }
  @media (max-width: 700px) {
    .container {
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    .column {
      max-width: 90vw;
      height: auto;
    }
    .words-container {
      justify-content: center;
      gap: 10px;
    }
    .word {
      font-size: 1.4em;
      padding: 12px 16px;
    }
    #button-container {
      flex-direction: column;
      gap: 15px;
    }
    #btnRestart, #btnPrev, a#back-home {
      width: 100%;
      max-width: 300px;
      margin: 0 auto;
    }
  }
</style>
</head>
<body>

<h1>華台動物語詞配對</h1>
<div id="subtitle">tshi̍h 華文抑是台語攏會使，配對成功會有台語聲音檔喔！</div>

<div id="button-container">
  <button id="btnPrev">上一回</button>
  <button id="btnRestart">閣耍一擺</button>
  <a id="back-home" href="index.html">← 回到遊戲首頁</a>
</div>

<div id="score">分數：0</div>

<div class="container">
  <div class="column" id="mandarin">
    <div class="column-header">中文</div>
    <div class="words-container" id="mandarin-words"></div>
  </div>
  <div class="column" id="taiwanese">
    <div class="column-header">台語</div>
    <div class="words-container" id="taiwanese-words"></div>
  </div>
</div>

<audio id="correctSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_8a8ecf9b1f.mp3"></audio>
<audio id="winSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_7e0f2cc5d3.mp3"></audio>

<script>
const allWordGroups = [
  [
    { zh: "老鷹", tw: "鴟鴞", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7881.mp3" },
    { zh: "鸚鵡", tw: "鸚哥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/13/13421.mp3" },
    { zh: "穿山甲", tw: "鯪鯉", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12938.mp3" },
    { zh: "蝙蝠", tw: "夜婆", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3792.mp3" },
    { zh: "青蛙", tw: "水雞", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1192.mp3" },
    { zh: "蜥蜴", tw: "杜定", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3234.mp3" },
    { zh: "企鵝", tw: "徛鵝", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7282.mp3" },
    { zh: "黑面琵鷺", tw: "烏面抐桮", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6270.mp3" },
    { zh: "老鼠", tw: "鳥鼠", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/8/8129.mp3" },
    { zh: "松鼠", tw: "膨鼠", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11877.mp3" }
  ],
  [
    { zh: "夜鷺", tw: "暗光鳥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9585.mp3" },
    { zh: "五色鳥", tw: "花仔和尚", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/27/27448.mp3" },
    { zh: "鴿子", tw: "粉鳥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6452.mp3" },
    { zh: "八哥", tw: "鵁钞", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12470.mp3" },
    { zh: "喜鵲", tw: "客鳥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4879.mp3" },
    { zh: "灰面鵟鷹", tw: "南路鷹", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4745.mp3" },
    { zh: "候鳥", tw: "過冬鳥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/27/27326.mp3" },
    { zh: "貓頭鷹", tw: "貓頭鳥", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/11/11943.mp3" },
    { zh: "白頭翁", tw: "白頭鵠仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/2/2016.mp3" },
    { zh: "臺灣藍鵲", tw: "長尾山娘", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/RB/fx/295521.mp3" }
  ],
  [
    { zh: "公牛", tw: "牛犅", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1263.mp3" },
    { zh: "白鼻心", tw: "果子猫", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4197.mp3" },
    { zh: "石虎", tw: "山貓", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/531.mp3" },
    { zh: "小鴨子", tw: "鴨咪仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12102.mp3" },
    { zh: "綠綉眼", tw: "青苔仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/27/27536.mp3" },
    { zh: "麻雀", tw: "厝角鳥仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5822.mp3" },
    { zh: "雨傘節", tw: "簸箕甲", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12830.mp3" },
    { zh: "眼鏡蛇", tw: "飯匙銃", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9258.mp3" },
    { zh: "壁虎", tw: "蟮蟲仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12611.mp3" },
    { zh: "蝌蚪", tw: "肚胿仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3369.mp3" }
  ]
];

let currentGroupIndex = 0;
let score = 0;
let selected = { zh: null, tw: null };

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function createWordElement(text, type, audioUrl) {
  const div = document.createElement("div");
  div.className = "word";
  div.textContent = text;
  div.onclick = function() {
    if (div.classList.contains("matched")) return;
    if (selected[type] === div) {
      div.classList.remove("selected");
      selected[type] = null;
      return;
    }
    if (selected[type]) selected[type].classList.remove("selected");
    div.classList.add("selected");
    selected[type] = div;
    if (selected.zh && selected.tw) checkMatch();
  };
  div.dataset.audio = audioUrl || "";
  return div;
}

function checkMatch() {
  const zhText = selected.zh.textContent;
  const twText = selected.tw.textContent;
  const group = allWordGroups[currentGroupIndex];
  const match = group.find(w => w.zh === zhText && w.tw === twText);
  if (match) {
    selected.zh.classList.add("matched");
    selected.tw.classList.add("matched");

    const correctSound = document.getElementById("correctSound");
    correctSound.currentTime = 0;
    correctSound.play();
    correctSound.onended = () => {
      playAudio(match.audio);
      correctSound.onended = null;
    };

    score++;
    document.getElementById("score").textContent = `分數：${score}`;
    if (score === group.length) {
      setTimeout(() => {
        document.getElementById("winSound").play();
        alert("攏 tio̍h，有夠gâu的！");
      }, 300);
    }
  }
  selected.zh.classList.remove("selected");
  selected.tw.classList.remove("selected");
  selected.zh = null;
  selected.tw = null;
}

function playAudio(url) {
  const audio = new Audio(url);
  audio.play();
}

function initGame() {
  score = 0;
  document.getElementById("score").textContent = `分數：${score}`;
  selected.zh = null;
  selected.tw = null;

  const group = allWordGroups[currentGroupIndex];

  const zhContainer = document.getElementById("mandarin-words");
  const twContainer = document.getElementById("taiwanese-words");
  zhContainer.innerHTML = "";
  twContainer.innerHTML = "";

  const zhList = shuffle([...group]);
  const twList = shuffle([...group]);

  zhList.forEach(w => {
    const el = createWordElement(w.zh, "zh");
    zhContainer.appendChild(el);
  });

  twList.forEach(w => {
    const link = `https://sutian.moe.edu.tw/zh-hant/search/${encodeURIComponent(w.tw)}`;
    const el = createWordElement(w.tw, "tw", w.audio);
    el.onclick = function() {
      if (selected.tw === el) {
        el.classList.remove("selected");
        selected.tw = null;
        return;
      }
      if (selected.tw) selected.tw.classList.remove("selected");
      el.classList.add("selected");
      selected.tw = el;
      if (selected.zh && selected.tw) checkMatch();
    };
    el.title = "雙擊查看教典詞條";
    el.style.cursor = "pointer";
    el.addEventListener("dblclick", () => window.open(link, "_blank"));
    twContainer.appendChild(el);
  });
}

document.getElementById("btnRestart").onclick = () => {
  initGame();
};

document.getElementById("btnPrev").onclick = () => {
  currentGroupIndex = (currentGroupIndex - 1 + allWordGroups.length) % allWordGroups.length;
  initGame();
};

initGame();
</script>

</body>
</html>
