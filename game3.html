<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8" />
  <title>台語字詞排序遊戲 - game3</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background-color: #f0f8ff;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      color: #333;
    }
    #sentence {
      font-size: 1.5em;
      margin: 20px;
      text-align: center;
    }
    #word-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .word {
      background-color: #fffacd;
      padding: 10px 15px;
      border: 2px solid #ccc;
      border-radius: 8px;
      cursor: grab;
      font-size: 1.2em;
    }
    .word.dragging {
      opacity: 0.5;
    }
    #controls {
      margin: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    button {
      padding: 10px 15px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
    }
    button:hover {
      background-color: #45a049;
    }
    #result {
      font-size: 1.2em;
      margin: 10px;
      font-weight: bold;
    }
    audio {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>台語字詞排序遊戲</h1>
<div id="sentence"></div>
<div id="word-container"></div>
<div id="controls">
  <button id="check-btn">檢查答案</button>
  <button id="next-btn">後一回</button>
  <button id="restart-btn">閣耍一擺</button>
  <button id="home-btn">回到遊戲首頁</button>
</div>
<div id="result"></div>
<div id="audio-container"></div>

<script>
const questionSets = [
  // 第一組題目
  [
    { word: "半老老", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4926.mp3" },
    { word: "苦力", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9051.mp3" },
    { word: "散工", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/365.mp3" },
    { word: "大官虎", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1178.mp3" },
    { word: "抓耙仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6348.mp3" },
    { word: "摸飛", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6454.mp3" },
    { word: "挲圓仔湯", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7877.mp3" },
    { word: "摠頭", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/7/7360.mp3" },
    { word: "二步七仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/2/2580.mp3" },
    { word: "健丟", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5675.mp3" }
  ],
  // 第二組題目
  [
    { word: "電火球", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/10/10469.mp3" },
    { word: "烏貓", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6780.mp3" },
    { word: "草蜢仔", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/2/2471.mp3" },
    { word: "花貓", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3142.mp3" },
    { word: "金絲貓", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5226.mp3" },
    { word: "紅目鰱", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3002.mp3" },
    { word: "火燒魚", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/2/2800.mp3" },
    { word: "水牛", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9124.mp3" },
    { word: "狗公", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4029.mp3" },
    { word: "烏鴉", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/6/6845.mp3" }
  ],
  // 第三組題目
  [
    { word: "公牛", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1263.mp3" },
    { word: "白鼻心", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4197.mp3" },
    { word: "石虎", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/531.mp3" },
    { word: "小鴨子", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12102.mp3" },
    { word: "綠綉眼", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/27/27536.mp3" },
    { word: "麻雀", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5822.mp3" },
    { word: "雨傘節", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12830.mp3" },
    { word: "眼鏡蛇", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/9/9258.mp3" },
    { word: "壁虎", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12611.mp3" },
    { word: "蝌蚪", audio: "https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/3/3369.mp3" }
  ]
];

let currentSet = 0;
let currentQuestion = 0;

function loadQuestion() {
  const sentenceDiv = document.getElementById("sentence");
  const container = document.getElementById("word-container");
  const audioContainer = document.getElementById("audio-container");
  const question = questionSets[currentSet][currentQuestion];

  sentenceDiv.textContent = "請依順序排列台語詞語";
  container.innerHTML = "";
  audioContainer.innerHTML = `<audio controls autoplay src="${question.audio}"></audio>`;

  const words = question.word.split("");
  words.forEach(w => {
    const div = document.createElement("div");
    div.className = "word";
    div.textContent = w;
    div.draggable = true;
    div.addEventListener("dragstart", () => div.classList.add("dragging"));
    div.addEventListener("dragend", () => div.classList.remove("dragging"));
    container.appendChild(div);
  });
}

document.getElementById("check-btn").addEventListener("click", () => {
  const container = document.getElementById("word-container");
  const arranged = Array.from(container.children).map(el => el.textContent).join("");
  const correct = questionSets[currentSet][currentQuestion].word;
  document.getElementById("result").textContent = arranged === correct ? "✅ 正確！" : "❌ 再試試！";
});

document.getElementById("next-btn").addEventListener("click", () => {
  currentQuestion++;
  if (currentQuestion >= questionSets[currentSet].length) {
    currentQuestion = 0;
    currentSet = (currentSet + 1) % questionSets.length;
  }
  loadQuestion();
});

document.getElementById("restart-btn").addEventListener("click", () => {
  currentSet = 0;
  currentQuestion = 0;
  loadQuestion();
});

document.getElementById("home-btn").addEventListener("click", () => {
  window.location.href = "index.html";
});

document.getElementById("word-container").addEventListener("dragover", e => {
  e.preventDefault();
  const afterElement = getDragAfterElement(document.getElementById("word-container"), e.clientX);
  const dragging = document.querySelector(".dragging");
  if (afterElement == null) {
    document.getElementById("word-container").appendChild(dragging);
  } else {
    document.getElementById("word-container").insertBefore(dragging, afterElement);
  }
});

function getDragAfterElement(container, x) {
  const draggableElements = [...container.querySelectorAll(".word:not(.dragging)")];
  return draggableElements.reduce((closest, child) => {
    const box = child.getBoundingClientRect();
    const offset = x - box.left - box.width / 2;
    if (offset < 0 && offset > closest.offset) {
      return { offset: offset, element: child };
    } else {
      return closest;
    }
  }, { offset: Number.NEGATIVE_INFINITY }).element;
}

loadQuestion();
</script>

</body>
</html>
