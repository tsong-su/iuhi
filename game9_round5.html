<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>æœå­éª°ä»”éŠæˆ²-ç¬¬1å›</title>
<style>
  body {
    font-family: "Microsoft JhengHei", sans-serif;
    text-align: center;
    background: #fff8f0;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin: 15px 0;
    color: #d35400;
  }
  .scene {
    width: 240px;
    height: 240px;
    margin: 20px auto;
    perspective: 1000px;
  }
  .cube {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
  }
  .face {
    position: absolute;
    width: 240px;
    height: 240px;
    border: 4px solid #d35400;
    border-radius: 20px;
    background: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .face img {
    width: 200px;
    height: 200px;
    border-radius: 15px;
  }
  .front  { transform: rotateY(   0deg) translateZ(120px); }
  .back   { transform: rotateY( 180deg) translateZ(120px); }
  .right  { transform: rotateY(  90deg) translateZ(120px); }
  .left   { transform: rotateY( -90deg) translateZ(120px); }
  .top    { transform: rotateX(  90deg) translateZ(120px); }
  .bottom { transform: rotateX( -90deg) translateZ(120px); }

  button {
    margin: 8px;
    padding: 10px 20px;
    border: none;
    border-radius: 10px;
    background: #e67e22;
    color: #fff;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover {
    background: #d35400;
  }
  #result {
    margin-top: 15px;
    font-size: 20px;
    color: #2c3e50;
  }
</style>
</head>
<body>
<h1>æœå­éª°ä»”éŠæˆ²-ç¬¬1å›</h1>

<div class="scene">
  <div class="cube" id="cube">
    <div class="face front"><img src="fruit1.png" alt="æª¨ä»”"></div>
    <div class="face back"><img src="fruit2.png" alt="æŸ‘ä»”"></div>
    <div class="face right"><img src="fruit3.png" alt="å¼“è•‰"></div>
    <div class="face left"><img src="fruit4.png" alt="æ—èä»”"></div>
    <div class="face top"><img src="fruit5.png" alt="ç‹æ¢¨"></div>
    <div class="face bottom"><img src="fruit6.png" alt="æ™‚è¨ˆæœ"></div>
  </div>
</div>

<button id="rollBtn">ğŸ² æ“²éª°å­</button>
<button id="playPron" style="display:none;">ğŸ”Š æ’­æ”¾ç™¼éŸ³</button>
<div id="result">
  <div id="fruitName"></div>
  <div id="fruitRoman"></div>
</div>
<br>
<button onclick="location.href='game9_round2.html'">å¾Œä¸€å›</button>
<button onclick="location.href='index.html'">å›é¦–é </button>

<audio id="rollSound" src="Roll_the_dice.mp3" preload="auto"></audio>
<audio id="dingSound" src="ding.mp3" preload="auto"></audio>
<audio id="fruitSound" preload="auto"></audio>

<script>
const fruits = [
  { name:"æª¨ä»”", roman:"suÄinn-Ã¡", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/12/12189.mp3" },
  { name:"æŸ‘ä»”", roman:"kam-Ã¡", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/5/5084.mp3" },
  { name:"å¼“è•‰", roman:"king-tsio", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/0/529.mp3" },
  { name:"æ—èä»”", roman:"nÃ¡-puaÌt-Ã¡", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/4/4237.mp3" },
  { name:"ç‹æ¢¨", roman:"Ã´ng-lÃ¢i", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/1/1260.mp3" },
  { name:"æ™‚è¨ˆæœ", roman:"sÃ®-kÃ¨-kÃ³", audio:"https://sutian.moe.edu.tw/media/senn/mp3/imtong/subak/14/14205.mp3" }
];

// æ¯å€‹é¢å›ºå®šè§’åº¦ (å°æ‡‰ä¸Šé¢ HTML cube çš„ 6 å€‹ face)
const faceRotations = [
  {x:0,   y:0},    // front â†’ æª¨ä»”
  {x:0,   y:180},  // back  â†’ æŸ‘ä»”
  {x:0,   y:-90},  // right â†’ å¼“è•‰
  {x:0,   y:90},   // left  â†’ æ—èä»”
  {x:-90, y:0},    // top   â†’ ç‹æ¢¨
  {x:90,  y:0}     // bottomâ†’ æ™‚è¨ˆæœ
];

const cube = document.getElementById('cube');
const rollBtn = document.getElementById('rollBtn');
const fruitNameEl = document.getElementById('fruitName');
const fruitRomanEl = document.getElementById('fruitRoman');
const playPronBtn = document.getElementById('playPron');
const rollSound = document.getElementById('rollSound');
const dingSound = document.getElementById('dingSound');
const fruitSound = document.getElementById('fruitSound');

let animating = false;
let currentIndex = null;
let currentX = 0, currentY = 0;

// å»ºç«‹æ´—ç‰Œé™£åˆ—ï¼Œç¢ºä¿æ¯6æ¬¡å‡ºç¾ä¸€æ¬¡å®Œæ•´
let sequence = [];
function refillSequence(){
  sequence = [0,1,2,3,4,5];
  for (let i=sequence.length-1; i>0; i--){
    const j = Math.floor(Math.random()*(i+1));
    [sequence[i], sequence[j]] = [sequence[j], sequence[i]];
  }
}
refillSequence();

function rollDice(){
  if(animating) return;
  animating = true;
  fruitNameEl.textContent = "";
  fruitRomanEl.textContent = "";
  playPronBtn.style.display = "none";
  currentIndex = null;

  rollSound.currentTime = 0;
  rollSound.loop = true;
  rollSound.play().catch(()=>{});

  // å¾åºåˆ—å–ä¸‹ä¸€å€‹å€¼
  if(sequence.length === 0) refillSequence();
  const chosen = sequence.pop();
  currentIndex = chosen;

  const base = faceRotations[chosen];
  const extraX = 360*(3+Math.floor(Math.random()*2));
  const extraY = 360*(3+Math.floor(Math.random()*2));
  currentX += extraX + base.x;
  currentY += extraY + base.y;

  cube.style.transition = "transform 2s cubic-bezier(.19,.57,.3,.98)";
  cube.style.transform = `rotateX(${currentX}deg) rotateY(${currentY}deg)`;

  setTimeout(()=>{
    rollSound.loop=false; rollSound.pause();
    dingSound.currentTime=0; dingSound.play().catch(()=>{});

    const f = fruits[chosen];
    fruitNameEl.textContent = f.name;
    fruitRomanEl.textContent = f.roman;
    playPronBtn.style.display = "inline-block";
    fruitSound.src = f.audio;

    animating = false;
  }, 2000);
}

rollBtn.addEventListener('click', rollDice);
playPronBtn.addEventListener('click', ()=>{
  if(currentIndex===null) return;
  fruitSound.currentTime=0; fruitSound.play().catch(()=>{});
});
</script>
</body>
</html>
